webpackJsonp([1],{1220:function(e,t){},1221:function(e,t){},1222:function(e,t){},1223:function(e,t){},1224:function(e,t){},1225:function(e,t){},1226:function(e,t){},1227:function(e,t){},1228:function(e,t){},1229:function(e,t){},1230:function(e,t,n){"use strict";var r;!function(a){function o(e,t,n){var r,a,o,i,s,c,u,l,y,v=0,b=[],w=0,E=!1,S=[],C=[],O=!1,k=!1;if(n=n||{},r=n.encoding||"UTF8",y=n.numRounds||1,o=g(t,r),y!==parseInt(y,10)||1>y)throw Error("numRounds must a integer >= 1");if("SHA-1"===e)s=512,c=q,u=H,i=160,l=function(e){return e.slice()};else if(0===e.lastIndexOf("SHA-",0))if(c=function(t,n){return W(t,n,e)},u=function(t,n,r,a){var o,i;if("SHA-224"===e||"SHA-256"===e)o=15+(n+65>>>9<<4),i=16;else{if("SHA-384"!==e&&"SHA-512"!==e)throw Error("Unexpected error in SHA-2 implementation");o=31+(n+129>>>10<<5),i=32}for(;t.length<=o;)t.push(0);for(t[n>>>5]|=128<<24-n%32,n+=r,t[o]=4294967295&n,t[o-1]=n/4294967296|0,r=t.length,n=0;n<r;n+=i)a=W(t.slice(n,n+i),a,e);if("SHA-224"===e)t=[a[0],a[1],a[2],a[3],a[4],a[5],a[6]];else if("SHA-256"===e)t=a;else if("SHA-384"===e)t=[a[0].a,a[0].b,a[1].a,a[1].b,a[2].a,a[2].b,a[3].a,a[3].b,a[4].a,a[4].b,a[5].a,a[5].b];else{if("SHA-512"!==e)throw Error("Unexpected error in SHA-2 implementation");t=[a[0].a,a[0].b,a[1].a,a[1].b,a[2].a,a[2].b,a[3].a,a[3].b,a[4].a,a[4].b,a[5].a,a[5].b,a[6].a,a[6].b,a[7].a,a[7].b]}return t},l=function(e){return e.slice()},"SHA-224"===e)s=512,i=224;else if("SHA-256"===e)s=512,i=256;else if("SHA-384"===e)s=1024,i=384;else{if("SHA-512"!==e)throw Error("Chosen SHA variant is not supported");s=1024,i=512}else{if(0!==e.lastIndexOf("SHA3-",0)&&0!==e.lastIndexOf("SHAKE",0))throw Error("Chosen SHA variant is not supported");var T=6;if(c=z,l=function(e){var t,n=[];for(t=0;5>t;t+=1)n[t]=e[t].slice();return n},"SHA3-224"===e)s=1152,i=224;else if("SHA3-256"===e)s=1088,i=256;else if("SHA3-384"===e)s=832,i=384;else if("SHA3-512"===e)s=576,i=512;else if("SHAKE128"===e)s=1344,i=-1,T=31,k=!0;else{if("SHAKE256"!==e)throw Error("Chosen SHA variant is not supported");s=1088,i=-1,T=31,k=!0}u=function(e,t,n,r,a){n=s;var o,i=T,c=[],u=n>>>5,l=0,p=t>>>5;for(o=0;o<p&&t>=n;o+=u)r=z(e.slice(o,o+u),r),t-=n;for(e=e.slice(o),t%=n;e.length<u;)e.push(0);for(o=t>>>3,e[o>>2]^=i<<24-o%4*8,e[u-1]^=128,r=z(e,r);32*c.length<a&&(e=r[l%5][l/5|0],c.push((255&e.b)<<24|(65280&e.b)<<8|(16711680&e.b)>>8|e.b>>>24),!(32*c.length>=a));)c.push((255&e.a)<<24|(65280&e.a)<<8|(16711680&e.a)>>8|e.a>>>24),0==64*(l+=1)%n&&z(null,r);return c}}a=L(e),this.setHMACKey=function(t,n,o){var l;if(!0===E)throw Error("HMAC key already set");if(!0===O)throw Error("Cannot set HMAC key after calling update");if(!0===k)throw Error("SHAKE is not supported for HMAC");if(r=(o||{}).encoding||"UTF8",n=g(n,r)(t),t=n.binLen,n=n.value,l=s>>>3,o=l/4-1,l<t/8){for(n=u(n,t,0,L(e),i);n.length<=o;)n.push(0);n[o]&=4294967040}else if(l>t/8){for(;n.length<=o;)n.push(0);n[o]&=4294967040}for(t=0;t<=o;t+=1)S[t]=909522486^n[t],C[t]=1549556828^n[t];a=c(S,a),v=s,E=!0},this.update=function(e){var t,n,r,i=0,u=s>>>5;for(t=o(e,b,w),e=t.binLen,n=t.value,t=e>>>5,r=0;r<t;r+=u)i+s<=e&&(a=c(n.slice(r,r+u),a),i+=s);v+=i,b=n.slice(i>>>5),w=e%s,O=!0},this.getHash=function(t,n){var r,o,s,c;if(!0===E)throw Error("Cannot call getHash after setting HMAC key");if(s=m(n),!0===k){if(-1===s.shakeLen)throw Error("shakeLen must be specified in options");i=s.shakeLen}switch(t){case"HEX":r=function(e){return p(e,i,s)};break;case"B64":r=function(e){return f(e,i,s)};break;case"BYTES":r=function(e){return h(e,i)};break;case"ARRAYBUFFER":try{o=new ArrayBuffer(0)}catch(e){throw Error("ARRAYBUFFER not supported by this environment")}r=function(e){return d(e,i)};break;default:throw Error("format must be HEX, B64, BYTES, or ARRAYBUFFER")}for(c=u(b.slice(),w,v,l(a),i),o=1;o<y;o+=1)!0===k&&0!=i%32&&(c[c.length-1]&=4294967040<<24-i%32),c=u(c,i,0,L(e),i);return r(c)},this.getHMAC=function(t,n){var r,o,g,y;if(!1===E)throw Error("Cannot call getHMAC without first setting HMAC key");switch(g=m(n),t){case"HEX":r=function(e){return p(e,i,g)};break;case"B64":r=function(e){return f(e,i,g)};break;case"BYTES":r=function(e){return h(e,i)};break;case"ARRAYBUFFER":try{r=new ArrayBuffer(0)}catch(e){throw Error("ARRAYBUFFER not supported by this environment")}r=function(e){return d(e,i)};break;default:throw Error("outputFormat must be HEX, B64, BYTES, or ARRAYBUFFER")}return o=u(b.slice(),w,v,l(a),i),y=c(C,L(e)),y=u(o,i,s,y,i),r(y)}}function i(e,t){this.a=e,this.b=t}function s(e,t,n){var r,a,o,i,s,c=e.length;if(t=t||[0],n=n||0,s=n>>>3,0!=c%2)throw Error("String of HEX type must be in byte increments");for(r=0;r<c;r+=2){if(a=parseInt(e.substr(r,2),16),isNaN(a))throw Error("String of HEX type contains invalid characters");for(i=(r>>>1)+s,o=i>>>2;t.length<=o;)t.push(0);t[o]|=a<<8*(3-i%4)}return{value:t,binLen:4*c+n}}function c(e,t,n){var r,a,o,i,s=[],s=t||[0];for(n=n||0,a=n>>>3,r=0;r<e.length;r+=1)t=e.charCodeAt(r),i=r+a,o=i>>>2,s.length<=o&&s.push(0),s[o]|=t<<8*(3-i%4);return{value:s,binLen:8*e.length+n}}function u(e,t,n){var r,a,o,i,s,c,u=[],l=0,u=t||[0];if(n=n||0,t=n>>>3,-1===e.search(/^[a-zA-Z0-9=+\/]+$/))throw Error("Invalid character in base-64 string");if(a=e.indexOf("="),e=e.replace(/\=/g,""),-1!==a&&a<e.length)throw Error("Invalid '=' found in base-64 string");for(a=0;a<e.length;a+=4){for(s=e.substr(a,4),o=i=0;o<s.length;o+=1)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(s[o]),i|=r<<18-6*o;for(o=0;o<s.length-1;o+=1){for(c=l+t,r=c>>>2;u.length<=r;)u.push(0);u[r]|=(i>>>16-8*o&255)<<8*(3-c%4),l+=1}}return{value:u,binLen:8*l+n}}function l(e,t,n){var r,a,o,i=[],i=t||[0];for(n=n||0,r=n>>>3,t=0;t<e.byteLength;t+=1)o=t+r,a=o>>>2,i.length<=a&&i.push(0),i[a]|=e[t]<<8*(3-o%4);return{value:i,binLen:8*e.byteLength+n}}function p(e,t,n){var r="";t/=8;var a,o;for(a=0;a<t;a+=1)o=e[a>>>2]>>>8*(3-a%4),r+="0123456789abcdef".charAt(o>>>4&15)+"0123456789abcdef".charAt(15&o);return n.outputUpper?r.toUpperCase():r}function f(e,t,n){var r,a,o,i="",s=t/8;for(r=0;r<s;r+=3)for(a=r+1<s?e[r+1>>>2]:0,o=r+2<s?e[r+2>>>2]:0,o=(e[r>>>2]>>>8*(3-r%4)&255)<<16|(a>>>8*(3-(r+1)%4)&255)<<8|o>>>8*(3-(r+2)%4)&255,a=0;4>a;a+=1)i+=8*r+6*a<=t?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(o>>>6*(3-a)&63):n.b64Pad;return i}function h(e,t){var n,r,a="",o=t/8;for(n=0;n<o;n+=1)r=e[n>>>2]>>>8*(3-n%4)&255,a+=String.fromCharCode(r);return a}function d(e,t){var n,r=t/8,a=new ArrayBuffer(r);for(n=0;n<r;n+=1)a[n]=e[n>>>2]>>>8*(3-n%4)&255;return a}function m(e){var t={outputUpper:!1,b64Pad:"=",shakeLen:-1};if(e=e||{},t.outputUpper=e.outputUpper||!1,!0===e.hasOwnProperty("b64Pad")&&(t.b64Pad=e.b64Pad),!0===e.hasOwnProperty("shakeLen")){if(0!=e.shakeLen%8)throw Error("shakeLen must be a multiple of 8");t.shakeLen=e.shakeLen}if("boolean"!=typeof t.outputUpper)throw Error("Invalid outputUpper formatting option");if("string"!=typeof t.b64Pad)throw Error("Invalid b64Pad formatting option");return t}function g(e,t){var n;switch(t){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(e){case"HEX":n=s;break;case"TEXT":n=function(e,n,r){var a,o,i,s,c,u=[],l=[],p=0,u=n||[0];if(n=r||0,i=n>>>3,"UTF8"===t)for(a=0;a<e.length;a+=1)for(r=e.charCodeAt(a),l=[],128>r?l.push(r):2048>r?(l.push(192|r>>>6),l.push(128|63&r)):55296>r||57344<=r?l.push(224|r>>>12,128|r>>>6&63,128|63&r):(a+=1,r=65536+((1023&r)<<10|1023&e.charCodeAt(a)),l.push(240|r>>>18,128|r>>>12&63,128|r>>>6&63,128|63&r)),o=0;o<l.length;o+=1){for(c=p+i,s=c>>>2;u.length<=s;)u.push(0);u[s]|=l[o]<<8*(3-c%4),p+=1}else if("UTF16BE"===t||"UTF16LE"===t)for(a=0;a<e.length;a+=1){for(r=e.charCodeAt(a),"UTF16LE"===t&&(o=255&r,r=o<<8|r>>>8),c=p+i,s=c>>>2;u.length<=s;)u.push(0);u[s]|=r<<8*(2-c%4),p+=2}return{value:u,binLen:8*p+n}};break;case"B64":n=u;break;case"BYTES":n=c;break;case"ARRAYBUFFER":try{n=new ArrayBuffer(0)}catch(e){throw Error("ARRAYBUFFER not supported by this environment")}n=l;break;default:throw Error("format must be HEX, TEXT, B64, BYTES, or ARRAYBUFFER")}return n}function y(e,t){return e<<t|e>>>32-t}function v(e,t){return 32<t?(t-=32,new i(e.b<<t|e.a>>>32-t,e.a<<t|e.b>>>32-t)):0!==t?new i(e.a<<t|e.b>>>32-t,e.b<<t|e.a>>>32-t):e}function b(e,t){return e>>>t|e<<32-t}function w(e,t){var n=null,n=new i(e.a,e.b);return n=32>=t?new i(n.a>>>t|n.b<<32-t&4294967295,n.b>>>t|n.a<<32-t&4294967295):new i(n.b>>>t-32|n.a<<64-t&4294967295,n.a>>>t-32|n.b<<64-t&4294967295)}function E(e,t){return 32>=t?new i(e.a>>>t,e.b>>>t|e.a<<32-t&4294967295):new i(0,e.a>>>t-32)}function S(e,t,n){return e&t^~e&n}function C(e,t,n){return new i(e.a&t.a^~e.a&n.a,e.b&t.b^~e.b&n.b)}function O(e,t,n){return e&t^e&n^t&n}function k(e,t,n){return new i(e.a&t.a^e.a&n.a^t.a&n.a,e.b&t.b^e.b&n.b^t.b&n.b)}function T(e){return b(e,2)^b(e,13)^b(e,22)}function N(e){var t=w(e,28),n=w(e,34);return e=w(e,39),new i(t.a^n.a^e.a,t.b^n.b^e.b)}function P(e){return b(e,6)^b(e,11)^b(e,25)}function j(e){var t=w(e,14),n=w(e,18);return e=w(e,41),new i(t.a^n.a^e.a,t.b^n.b^e.b)}function _(e){return b(e,7)^b(e,18)^e>>>3}function R(e){var t=w(e,1),n=w(e,8);return e=E(e,7),new i(t.a^n.a^e.a,t.b^n.b^e.b)}function I(e){return b(e,17)^b(e,19)^e>>>10}function D(e){var t=w(e,19),n=w(e,61);return e=E(e,6),new i(t.a^n.a^e.a,t.b^n.b^e.b)}function A(e,t){var n=(65535&e)+(65535&t);return((e>>>16)+(t>>>16)+(n>>>16)&65535)<<16|65535&n}function B(e,t,n,r){var a=(65535&e)+(65535&t)+(65535&n)+(65535&r);return((e>>>16)+(t>>>16)+(n>>>16)+(r>>>16)+(a>>>16)&65535)<<16|65535&a}function M(e,t,n,r,a){var o=(65535&e)+(65535&t)+(65535&n)+(65535&r)+(65535&a);return((e>>>16)+(t>>>16)+(n>>>16)+(r>>>16)+(a>>>16)+(o>>>16)&65535)<<16|65535&o}function V(e,t){var n,r,a;return n=(65535&e.b)+(65535&t.b),r=(e.b>>>16)+(t.b>>>16)+(n>>>16),a=(65535&r)<<16|65535&n,n=(65535&e.a)+(65535&t.a)+(r>>>16),r=(e.a>>>16)+(t.a>>>16)+(n>>>16),new i((65535&r)<<16|65535&n,a)}function x(e,t,n,r){var a,o,s;return a=(65535&e.b)+(65535&t.b)+(65535&n.b)+(65535&r.b),o=(e.b>>>16)+(t.b>>>16)+(n.b>>>16)+(r.b>>>16)+(a>>>16),s=(65535&o)<<16|65535&a,a=(65535&e.a)+(65535&t.a)+(65535&n.a)+(65535&r.a)+(o>>>16),o=(e.a>>>16)+(t.a>>>16)+(n.a>>>16)+(r.a>>>16)+(a>>>16),new i((65535&o)<<16|65535&a,s)}function U(e,t,n,r,a){var o,s,c;return o=(65535&e.b)+(65535&t.b)+(65535&n.b)+(65535&r.b)+(65535&a.b),s=(e.b>>>16)+(t.b>>>16)+(n.b>>>16)+(r.b>>>16)+(a.b>>>16)+(o>>>16),c=(65535&s)<<16|65535&o,o=(65535&e.a)+(65535&t.a)+(65535&n.a)+(65535&r.a)+(65535&a.a)+(s>>>16),s=(e.a>>>16)+(t.a>>>16)+(n.a>>>16)+(r.a>>>16)+(a.a>>>16)+(o>>>16),new i((65535&s)<<16|65535&o,c)}function F(e){var t,n=0,r=0;for(t=0;t<arguments.length;t+=1)n^=arguments[t].b,r^=arguments[t].a;return new i(r,n)}function L(e){var t,n=[];if("SHA-1"===e)n=[1732584193,4023233417,2562383102,271733878,3285377520];else if(0===e.lastIndexOf("SHA-",0))switch(n=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],t=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],e){case"SHA-224":break;case"SHA-256":n=t;break;case"SHA-384":n=[new i(3418070365,n[0]),new i(1654270250,n[1]),new i(2438529370,n[2]),new i(355462360,n[3]),new i(1731405415,n[4]),new i(41048885895,n[5]),new i(3675008525,n[6]),new i(1203062813,n[7])];break;case"SHA-512":n=[new i(t[0],4089235720),new i(t[1],2227873595),new i(t[2],4271175723),new i(t[3],1595750129),new i(t[4],2917565137),new i(t[5],725511199),new i(t[6],4215389547),new i(t[7],327033209)];break;default:throw Error("Unknown SHA variant")}else{if(0!==e.lastIndexOf("SHA3-",0)&&0!==e.lastIndexOf("SHAKE",0))throw Error("No SHA variants supported");for(e=0;5>e;e+=1)n[e]=[new i(0,0),new i(0,0),new i(0,0),new i(0,0),new i(0,0)]}return n}function q(e,t){var n,r,a,o,i,s,c,u=[];for(n=t[0],r=t[1],a=t[2],o=t[3],i=t[4],c=0;80>c;c+=1)u[c]=16>c?e[c]:y(u[c-3]^u[c-8]^u[c-14]^u[c-16],1),s=20>c?M(y(n,5),r&a^~r&o,i,1518500249,u[c]):40>c?M(y(n,5),r^a^o,i,1859775393,u[c]):60>c?M(y(n,5),O(r,a,o),i,2400959708,u[c]):M(y(n,5),r^a^o,i,3395469782,u[c]),i=o,o=a,a=y(r,30),r=n,n=s;return t[0]=A(n,t[0]),t[1]=A(r,t[1]),t[2]=A(a,t[2]),t[3]=A(o,t[3]),t[4]=A(i,t[4]),t}function H(e,t,n,r){var a;for(a=15+(t+65>>>9<<4);e.length<=a;)e.push(0);for(e[t>>>5]|=128<<24-t%32,t+=n,e[a]=4294967295&t,e[a-1]=t/4294967296|0,t=e.length,a=0;a<t;a+=16)r=q(e.slice(a,a+16),r);return r}function W(e,t,n){var r,a,o,s,c,u,l,p,f,h,d,m,g,y,v,b,w,E,F,L,q,H,W,z=[];if("SHA-224"===n||"SHA-256"===n)h=64,m=1,H=Number,g=A,y=B,v=M,b=_,w=I,E=T,F=P,q=O,L=S,W=Q;else{if("SHA-384"!==n&&"SHA-512"!==n)throw Error("Unexpected error in SHA-2 implementation");h=80,m=2,H=i,g=V,y=x,v=U,b=R,w=D,E=N,F=j,q=k,L=C,W=Y}for(n=t[0],r=t[1],a=t[2],o=t[3],s=t[4],c=t[5],u=t[6],l=t[7],d=0;d<h;d+=1)16>d?(f=d*m,p=e.length<=f?0:e[f],f=e.length<=f+1?0:e[f+1],z[d]=new H(p,f)):z[d]=y(w(z[d-2]),z[d-7],b(z[d-15]),z[d-16]),p=v(l,F(s),L(s,c,u),W[d],z[d]),f=g(E(n),q(n,r,a)),l=u,u=c,c=s,s=g(o,p),o=a,a=r,r=n,n=g(p,f);return t[0]=g(n,t[0]),t[1]=g(r,t[1]),t[2]=g(a,t[2]),t[3]=g(o,t[3]),t[4]=g(s,t[4]),t[5]=g(c,t[5]),t[6]=g(u,t[6]),t[7]=g(l,t[7]),t}function z(e,t){var n,r,a,o,s=[],c=[];if(null!==e)for(r=0;r<e.length;r+=2)t[(r>>>1)%5][(r>>>1)/5|0]=F(t[(r>>>1)%5][(r>>>1)/5|0],new i((255&e[r+1])<<24|(65280&e[r+1])<<8|(16711680&e[r+1])>>>8|e[r+1]>>>24,(255&e[r])<<24|(65280&e[r])<<8|(16711680&e[r])>>>8|e[r]>>>24));for(n=0;24>n;n+=1){for(o=L("SHA3-"),r=0;5>r;r+=1)s[r]=F(t[r][0],t[r][1],t[r][2],t[r][3],t[r][4]);for(r=0;5>r;r+=1)c[r]=F(s[(r+4)%5],v(s[(r+1)%5],1));for(r=0;5>r;r+=1)for(a=0;5>a;a+=1)t[r][a]=F(t[r][a],c[r]);for(r=0;5>r;r+=1)for(a=0;5>a;a+=1)o[a][(2*r+3*a)%5]=v(t[r][a],X[r][a]);for(r=0;5>r;r+=1)for(a=0;5>a;a+=1)t[r][a]=F(o[r][a],new i(~o[(r+1)%5][a].a&o[(r+2)%5][a].a,~o[(r+1)%5][a].b&o[(r+2)%5][a].b));t[0][0]=F(t[0][0],K[n])}return t}var Q,Y,X,K;Q=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Y=[new i(Q[0],3609767458),new i(Q[1],602891725),new i(Q[2],3964484399),new i(Q[3],2173295548),new i(Q[4],4081628472),new i(Q[5],3053834265),new i(Q[6],2937671579),new i(Q[7],3664609560),new i(Q[8],2734883394),new i(Q[9],1164996542),new i(Q[10],1323610764),new i(Q[11],3590304994),new i(Q[12],4068182383),new i(Q[13],991336113),new i(Q[14],633803317),new i(Q[15],3479774868),new i(Q[16],2666613458),new i(Q[17],944711139),new i(Q[18],2341262773),new i(Q[19],2007800933),new i(Q[20],1495990901),new i(Q[21],1856431235),new i(Q[22],3175218132),new i(Q[23],2198950837),new i(Q[24],3999719339),new i(Q[25],766784016),new i(Q[26],2566594879),new i(Q[27],3203337956),new i(Q[28],1034457026),new i(Q[29],2466948901),new i(Q[30],3758326383),new i(Q[31],168717936),new i(Q[32],1188179964),new i(Q[33],1546045734),new i(Q[34],1522805485),new i(Q[35],2643833823),new i(Q[36],2343527390),new i(Q[37],1014477480),new i(Q[38],1206759142),new i(Q[39],344077627),new i(Q[40],1290863460),new i(Q[41],3158454273),new i(Q[42],3505952657),new i(Q[43],106217008),new i(Q[44],3606008344),new i(Q[45],1432725776),new i(Q[46],1467031594),new i(Q[47],851169720),new i(Q[48],3100823752),new i(Q[49],1363258195),new i(Q[50],3750685593),new i(Q[51],3785050280),new i(Q[52],3318307427),new i(Q[53],3812723403),new i(Q[54],2003034995),new i(Q[55],3602036899),new i(Q[56],1575990012),new i(Q[57],1125592928),new i(Q[58],2716904306),new i(Q[59],442776044),new i(Q[60],593698344),new i(Q[61],3733110249),new i(Q[62],2999351573),new i(Q[63],3815920427),new i(3391569614,3928383900),new i(3515267271,566280711),new i(3940187606,3454069534),new i(4118630271,4000239992),new i(116418474,1914138554),new i(174292421,2731055270),new i(289380356,3203993006),new i(460393269,320620315),new i(685471733,587496836),new i(852142971,1086792851),new i(1017036298,365543100),new i(1126000580,2618297676),new i(1288033470,3409855158),new i(1501505948,4234509866),new i(1607167915,987167468),new i(1816402316,1246189591)],K=[new i(0,1),new i(0,32898),new i(2147483648,32906),new i(2147483648,2147516416),new i(0,32907),new i(0,2147483649),new i(2147483648,2147516545),new i(2147483648,32777),new i(0,138),new i(0,136),new i(0,2147516425),new i(0,2147483658),new i(0,2147516555),new i(2147483648,139),new i(2147483648,32905),new i(2147483648,32771),new i(2147483648,32770),new i(2147483648,128),new i(0,32778),new i(2147483648,2147483658),new i(2147483648,2147516545),new i(2147483648,32896),new i(0,2147483649),new i(2147483648,2147516424)],X=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]],void 0!==(r=function(){return o}.call(t,n,t,e))&&(e.exports=r)}()},1231:function(e,t){},1234:function(e,t){},1242:function(e,t,n){"use strict";function r(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(this,arguments)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function c(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function m(e){var t=e.captcha;return{captchaNeeded:t.captchaNeeded,captchaBase64String:t.captchaBase64String}}function g(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function w(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function C(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function N(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function R(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function I(e,t){var n=Date.now(),r=new en.a("SHA-1","TEXT");return r.setHMACKey("d1b964811afb40118a12068ff74a12f4","TEXT"),r.update(e),r.update(rn),r.update("com.zhihu.web"),r.update(String(n)),an({clientId:rn,grantType:e,timestamp:n,source:"com.zhihu.web",signature:r.getHMAC("HEX")},t)}function D(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function M(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function V(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}function x(e){return{hasCode:e.startsWith("+")||e.startsWith("00"),parsedPhoneNo:e.startsWith("00")?"+"+e.slice(2):e}}function U(e,t){if(!e)return{};e=e.trim();var n=e,r=dn(e);if(!r){var a=x(e),o=a.hasCode,i=a.parsedPhoneNo;n=o?i:""+t+e}return{value:n,isEmail:r}}function F(e,t,n,r){nt.a.trackEvent(e,{action:t,element:"Button",element_name:r},{account:n})}function L(e,t,n,r){nt.a.trackEvent(e,{id:236,action:"StatusReport",element_name:r},{status:{result:"Success",event:{action:t,element:"Button"}},account:n})}function q(e,t,n,r,a){var o="object"===(void 0===r?"undefined":mn(r))?Object.keys(r).map(function(e){return"object"===mn(r[e])?r[e].message:r[e]}):[r];nt.a.trackEvent(e,{action:"StatusReport",element_name:a},{status:{result:"Fail",error_msg:o,event:{action:t,element:"Button"}},account:n})}function H(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function z(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function Q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function X(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function K(e){var t=e.login;return{qrcodeLoginToken:t.qrcodeLoginToken,qrcodeLoginTokenExpires:t.qrcodeLoginTokenExpires,qrcodeLoginScanStatus:t.qrcodeLoginScanStatus,qrcodeLoginError:t.qrcodeLoginError,qrcodeLoginReturnNewToken:t.qrcodeLoginReturnNewToken,token:e.token}}function Z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function G(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function J(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function ee(e){var t=e.captcha,n=t.captchaValidationMessage,r=t.captchaNeeded,a=e.login;return{loginConfirmSucceeded:a.loginConfirmSucceeded,loginConfirmError:a.loginConfirmError,sendDigitsError:a.sendDigitsError,captchaValidationMessage:n,captchaNeeded:r,edition:e.env.edition}}function te(e){return{module:"digits"===e.type?"SMSSignInForm":"SignInForm",trackCardShow:!0,view:{id:235}}}function ne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function re(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function ae(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function oe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ie(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function se(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function ce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ue(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function le(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var pe,fe,he,de,me,ge,ye,ve,be,we,Ee,Se,Ce,Oe,ke,Te,Ne,Pe,je,_e,Re,Ie,De,Ae,Be,Me,Ve,xe,Ue,Fe,Le,qe,He,We,ze=n(0),Qe=n.n(ze),Ye=n(38),Xe=n(1),Ke=n.n(Xe),Ze=n(2),Ge=n.n(Ze),$e=(n(840),function(e){var t=e.className,n=e.onRef,o=r(e,["className","onRef"]);return Qe.a.createElement("div",a({ref:n,className:Ge()("Card",t)},o))}),Je=$e,et=n(4),tt=n(6),nt=n.n(tt),rt=n(109),at=n(3),ot=n(8),it=n(60),st=n(7),ct=n(166),ut=n(73),lt=n(798),pt=n(802),ft=n(11),ht=(n(841),function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}()),dt=(fe=pe=function(e){function t(){var e,n,r,a;o(this,t);for(var s=arguments.length,c=Array(s),u=0;u<s;u++)c[u]=arguments[u];return n=r=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),r.state={hovered:!0},r.handleMouseEnter=function(){r.setState({hovered:!0})},r.handleMouseLeave=function(){r.setState({hovered:!1})},a=n,i(r,a)}return s(t,e),ht(t,[{key:"componentWillReceiveProps",value:function(e){this.props.position!==e.position&&this.handleMouseLeave()}},{key:"shouldComponentUpdate",value:function(e,t){return this.props.position!==e.position||this.state.hovered!==t.hovered}},{key:"render",value:function(){var e=this.props,t=e.position,n=e.onUnMark,r=this.state.hovered;return Qe.a.createElement(at.default,{className:"ChineseCaptchaPoint",style:t,onClick:n,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,preset:"plain"},Qe.a.createElement(ft.a,{name:"captchaPointCircle",className:Ge()("ChineseCaptchaPoint-backIcon",{"ChineseCaptchaPoint-backIcon--hovered":r}),fill:r?"#0f88eb":"#aad9ff",width:20,height:20}),Qe.a.createElement(ft.a,{name:r?"captchaPointCancel":"captchaPointCircle",className:Ge()("ChineseCaptchaPoint-frontIcon",{"ChineseCaptchaPoint-frontIcon--hovered":r}),fill:r?"#ffffff":"#0f88eb",width:r?8:12,height:r?8:12}))}}]),t}(ze.Component),pe.propTypes={onUnMark:Ke.a.func.isRequired,position:Ke.a.object.isRequired},fe),mt=dt,gt=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),yt=7,vt=10,bt="最多只能选择 "+yt+" 个点",wt=60,Et=16,St=(de=he=function(e){function t(){var e,n,r,a;u(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=r=l(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.state={markPositionsArray:[],isClient:!1},r.handleMarkPoint=function(e){if(r.chineseCaptchaImg){var t=r.state.markPositionsArray,n=r.props.onValidation;if(t.length>=yt)return void n({validationMessage:bt});var a=e.pageX,o=e.pageY,i=r.chineseCaptchaImg.getBoundingClientRect(),s=i.top,u=i.left,l=o-s-window.pageYOffset-vt,p=a-u-window.pageXOffset-vt,f=[].concat(c(t),[{top:l,left:p+wt+Et}]);r.updateMarkPoint(f)}},r.handleUnMarkPoint=function(e){var t=[].concat(c(r.state.markPositionsArray));t.splice(e,1),r.updateMarkPoint(t)},r.updateMarkPoint=function(e){r.setState({markPositionsArray:e},function(){r.props.onUpdateInput(r.parseMarkPositionsArrayToInputValue(e))})},r.parseMarkPositionsArrayToInputValue=function(e){return JSON.stringify({img_size:[r.chineseImgWidth,r.chineseImgHeight],input_points:e.map(function(e){var t=e.top;return[e.left+vt-wt-Et,t+vt]})})},a=n,l(r,a)}return p(t,e),gt(t,[{key:"componentDidMount",value:function(){if(this.setState({isClient:!0}),this.chineseCaptchaImg){var e=this.chineseCaptchaImg.getBoundingClientRect();this.chineseImgWidth=e.width,this.chineseImgHeight=e.height}}},{key:"componentWillReceiveProps",value:function(e){this.props.url!==e.url&&this.props.isChinese&&this.setState({markPositionsArray:[]})}},{key:"shouldComponentUpdate",value:function(e,t){return this.props.url!==e.url||this.props.validationMessage!==e.validationMessage||this.props.isShown!==e.isShown||this.props.className!==e.className||this.state.markPositionsArray!==t.markPositionsArray}},{key:"renderCaptcha",value:function(){var e=this,t=this.props,n=t.url,r=t.isChinese,a=t.onRefresh;return n?Qe.a.createElement("div",{className:r?"Captcha-chineseContainer":"Captcha-englishContainer"},Qe.a.createElement("img",{"data-tooltip":"看不清楚？换一张",className:r?"Captcha-chineseImg":"Captcha-englishImg",src:n,alt:"图形验证码",onClick:r?this.handleMarkPoint:a,ref:r&&function(t){e.chineseCaptchaImg=t}}),r?this.state.markPositionsArray.map(function(t,n){return Qe.a.createElement(mt,{key:n,onUnMark:function(){return e.handleUnMarkPoint(n)},position:t})}):null):null}},{key:"render",value:function(){var e=this.props,t=e.isChinese,n=e.validationMessage,r=e.className,a=e.onUpdateInput,o=e.validations,i=e.isShown,s=e.onRefresh,c=this.state.isClient,u=this.renderCaptcha(),l={width:"0",height:"0",opacity:"0",overflow:"hidden",margin:"0",padding:"0",border:"0"};return Qe.a.createElement("div",{className:Ge()("Captcha",r,{"Captcha-chinese":t&&c}),style:i?{}:l},t?Qe.a.createElement("div",null,Qe.a.createElement("div",{className:"Captcha-chineseOperator"},Qe.a.createElement("span",{className:Ge()("Captcha-info",{"Captcha-error":Boolean(n)})},n||"请点击图中倒立的文字"),Qe.a.createElement(at.default,{className:"Captcha-chineseRefreshButton",preset:"plain",onClick:s},Qe.a.createElement(ot.Refresh,{size:20}))),u):Qe.a.createElement("div",null,Qe.a.createElement(pt.a,{name:"captcha",type:"text",errorMessageClassName:"Captcha-errorMessage",placeholder:"验证码",onChange:a,validations:i?o:[],manualValidateError:n,tabIndex:i?0:-1}),Qe.a.createElement("span",{className:"Captcha-englishImage"},u)))}}]),t}(ze.Component),he.propTypes={isChinese:Ke.a.bool,url:Ke.a.string,validationMessage:Ke.a.string,onValidation:Ke.a.func,onRefresh:Ke.a.func.isRequired,onUpdateInput:Ke.a.func.isRequired,isShown:Ke.a.bool,validations:Ke.a.array},he.defaultProps={isChinese:!1,isShown:!1,validations:[{type:"required",message:"请填写验证码",className:"Captcha-requiredErrorMessage"}]},de),Ct=St,Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kt=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Tt=(me=Object(et.connect)(m,{checkIfCaptchaNeeded:ut.c,requestForCaptcha:ut.e,resetCaptchaInfo:ut.f}))((ve=ye=function(e){function t(){var e,n,r,a;f(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=r=h(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.state={validationMessage:""},r.handleValidation=function(e){var t=e.message,n=e.needsRefresh;void 0!==(void 0===t?"undefined":Ot(t))&&r.setState({validationMessage:t});var a=r.props,o=a.captchaNeeded,i=a.checkIfCaptchaNeeded,s=a.requestForCaptcha;!o&&n?i(r.type,r.lang):n&&s(r.type,r.lang)},r.handleRefresh=function(){r.props.requestForCaptcha(r.type,r.lang)},a=n,h(r,a)}return d(t,e),kt(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.type,n=e.isChinese,r=e.checkIfCaptchaNeeded;this.lang=n?"cn":"en",this.type="register"===t?"register":"login",r(this.type,this.lang)}},{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.validationResult,r=void 0===n?{}:n,a=t.captchaNeeded,o=t.requestForCaptcha,i=e.validationResult,s=void 0===i?{}:i,c=e.captchaNeeded;!a&&c&&o(this.type,this.lang),r.timestamp!==s.timestamp&&this.handleValidation(s)}},{key:"componentWillUnmount",value:function(){this.props.resetCaptchaInfo()}},{key:"render",value:function(){var e=this.props,t=e.type,n=e.isChinese,r=e.onUpdateInput,a=e.captchaNeeded,o=e.className,i=e.canCaptchaShown,s=e.captchaBase64String,c=this.state.validationMessage,u=Boolean(i&&a&&s),l="digitsLogin"!==t?Ct.defaultProps.validations:[];return Qe.a.createElement(Ct,{className:o,isShown:u,isChinese:n,url:"data:image/jpg;base64,"+s,validationMessage:c,onRefresh:this.handleRefresh,onValidation:this.handleValidation,validations:l,onUpdateInput:r})}}]),t}(ze.Component),ye.propTypes={canCaptchaShown:Ke.a.bool,isChinese:Ke.a.bool,type:Ke.a.oneOf(["login","digitsLogin","register"]).isRequired,validationResult:Ke.a.object,captchaNeeded:Ke.a.bool,captchaBase64String:Ke.a.string,onUpdateInput:Ke.a.func,checkIfCaptchaNeeded:Ke.a.func,requestForCaptcha:Ke.a.func},ye.defaultProps={canCaptchaShown:!1,isChinese:!1},ge=ve))||ge,Nt=Tt,Pt=Nt,jt=n(803),_t=n(821),Rt=n(22),It=n.n(Rt),Dt=(n(1225),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}),At=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Bt=(we=be=function(e){function t(e){y(this,t);var n=v(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSwitchPasswordInputType=function(){n.setState(function(e){return{inputType:"password"===e.inputType?"text":"password"}})},n.handleChange=function(e){n.state.hasValue!==Boolean(e)&&n.setState({hasValue:Boolean(e)}),n.props.onChange(e)},n.state={hasValue:Boolean(e.defaultValue),inputType:e.defaultType},n}return b(t,e),At(t,[{key:"render",value:function(){var e=It()(this.props,["onChange","defaultType"]),t=e.switchDisabled,n=e.placeholderPrefix,r=g(e,["switchDisabled","placeholderPrefix"]),a=this.state,o=a.inputType,i=a.hasValue;return Qe.a.createElement("div",{className:"SignFlow-password"},Qe.a.createElement(pt.a,Dt({name:"password",inputClassName:"password"===o&&i?"SignFlow-passwordInput":"",type:o,placeholder:(n||"")+"密码",onChange:this.handleChange,errorMessageClassName:"SignFlow-passwordErrorMask",validations:[{type:"required",message:"请输入密码",className:"SignFlow-requiredPasswordErrorMask"}]},r)),!t&&Qe.a.createElement(at.default,{className:"SignFlow-switchPassword",tabIndex:-1,preset:"plain",onClick:this.handleSwitchPasswordInputType},Qe.a.createElement(ft.a,{className:"SignFlow-switchPasswordIcon",name:"password"===o?"inconspicuous":"read",width:24,height:20,style:{verticalAlign:"middle"}})))}}]),t}(ze.Component),be.propTypes={onChange:Ke.a.func.isRequired,switchDisabled:Ke.a.bool,defaultType:Ke.a.string},be.defaultProps={defaultType:"password"},we),Mt=(n(1226),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}),Vt=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),xt=(Se=Ee=function(e){function t(){return E(this,t),S(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return C(t,e),Vt(t,[{key:"render",value:function(){var e=this.props,t=e.onChange,n=w(e,["onChange"]);return Qe.a.createElement(pt.a,Mt({className:"SignFlow-username",onChange:t,validations:[{type:"required",message:"请输入用户名"}]},n))}}]),t}(ze.Component),Ee.propTypes={onChange:Ke.a.func.isRequired},Se),Ut=xt,Ft=(n(1227),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}),Lt=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),qt={phoneNoError:null,fullnameError:null,passwordError:null,digitsError:null},Ht=function(e){var t=e.captcha,n=t.captchaNeeded,r=t.captchaValidationMessage,a=e.register;return{captchaNeeded:n,sendDigitsError:a.sendDigitsError,registerValidateErrors:a.registerValidateErrors,captchaValidationMessage:r,registerConfirmSucceeded:a.registerConfirmSucceeded,edition:e.env.edition}},Wt=(Ce=Object(it.a)(function(){return{module:"SignUpForm",view:{id:233},trackCardShow:!0}}),Oe=Object(et.connect)(Ht,{sendDigits:ct.d,checkCaptcha:ut.b,validateDigits:ct.f,confirmRegister:ct.a,validateRegister:ct.g,validateRegisterForm:ct.h,resetRegisterValidateResult:ct.c}),Ce(ke=Oe(ke=function(e){function t(e){k(this,t);var n=T(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleCountDownEndEvent=function(){n.setState({smsBackUpDisplay:!0})},n.handleChange=function(e){return function(t){n.setState(O({},e,t))}},n.testPhoneNo=function(){var e=n.state,t=e.selectedCountry.code,r=e.phoneNo,a=/^\d{11}$/;return"+86"!==t||a.test(r)},n.handleBackUpDigits=function(){n.setState({smsType:"text"===n.state.smsType?"voice":"text",reStartTime:Date.now()})},n.sendDigits=function(){var e=n.props,t=e.sendDigits,r=e.validateRegisterForm;(0,e.resetRegisterValidateResult)();var a=n.state,o=a.phoneNo,i=a.selectedCountry,s=a.smsType,c=""+i.code+o;r({phoneNo:c}).then(function(e){if(e.payload.success)return n.setState({smsBackUpDisplay:!1}),void t(c,s);n.setState({smsInputInterceptTime:Date.now()})})},n.runBeforeCheckCaptcha=function(e){var t=n.state.captcha,r=n.props,a=r.captchaNeeded,o=r.checkCaptcha;if(!n.captchaValidated&&a)return t?void o(t,"register",n.captchaIsChinese?"cn":"en").then(function(t){t.payload.success&&(n.captchaValidated=!0,e())}):void n.setState({validationResult:{message:n.captchaIsChinese?"请点击图中倒立的文字":"请输入验证码",needsRefresh:!1,timestamp:Date.now()},smsInputInterceptTime:Date.now()});e()},n.runBeforeResetValidateResult=function(e){n.props.resetRegisterValidateResult(),n.setState({customErrorInputMap:Ft({},qt),validationResult:{needsRefresh:!1,timestamp:Date.now()}},function(){e()})},n.handleSendDigits=function(){n.runBeforeResetValidateResult(function(){var e=n.state.phoneNo;if(!n.testPhoneNo())return void n.setState({customErrorInputMap:Ft({},n.state.customErrorInputMap,{phoneNoError:e?"请输入正确的手机号":"请输入手机号"}),smsInputInterceptTime:Date.now()});n.runBeforeResetValidateResult(function(){n.runBeforeCheckCaptcha(function(){n.sendDigits()})})})},n.parseErrorMessages=function(){var e=n.props,t=e.registerValidateErrors,r=void 0===t?{}:t,a=e.onChangeToSigin,o=r.phoneNo,i=void 0===o?{}:o,s=r.fullname,c=void 0===s?{}:s,u=r.password,l=void 0===u?{}:u,p=r.username,f=void 0===p?"":p,h=i.code,d=i.message;return{phoneNoError:h===st.i?Qe.a.createElement("span",null,"该手机号已注册 · ",Qe.a.createElement(at.default,{preset:"plain",style:{color:"#3f3f3f"},onClick:function(){a()}},"直接登录")):d,fullnameError:c.message,passwordError:l.message,usernameError:f}},n.handleValidateDigits=function(e){n.runBeforeCheckCaptcha(function(){n.runBeforeResetValidateResult(function(){var t=e.digits,r=n.props,a=r.validateDigits,o=r.onSetShowHeader,i=n.state,s=i.phoneNo,c=i.selectedCountry;s&&t&&a(""+c.code+s,t).then(function(e){e.payload.success?n.setState({digitsValidated:!0},function(){o(!1)}):n.setState({customErrorInputMap:Ft({},n.state.customErrorInputMap,{digitsError:"验证码填写错误"})})})})})},n.handleSubmit=function(e){n.runBeforeCheckCaptcha(function(){n.runBeforeResetValidateResult(function(){var t=n.state,r=t.phoneNo,a=t.digits,o=t.password,i=t.fullname,s=t.selectedCountry,c=n.props,u=c.confirmRegister,l=c.validateRegister,p=c.nextUrl,f=c.edition,h={phoneNo:""+s.code+r,password:o,digits:a,fullname:i},d=Object(rt.extractSource)(p,f);l(h).then(function(t){t.payload.success&&u(Ft({phoneNo:""+s.code+r,digits:a,password:o,fullname:i||e.fullname,registerType:"phone_digits",source:"com.zhihu.web"},d))})})})},n.state={fullname:"",password:"",captcha:"",phoneNo:"",digits:"",smsType:"text",digitsValidated:!1,smsBackUpDisplay:!0,selectedCountry:{name:"中国",code:"+86"},validationResult:{},customErrorInputMap:Ft({},qt),smsInputInterceptTime:-1,reStartTime:Date.now()},n.captchaIsChinese=Math.random()<.5,n}return N(t,e),Lt(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.captchaValidationMessage,r=t.registerConfirmSucceeded,a=t.sendDigitsError,o=t.isInSignPage,i=t.nextUrl,s=e.captchaValidationMessage,c=e.registerConfirmSucceeded,u=e.sendDigitsError;if(!r&&c){var l=this.state,p=l.selectedCountry.code,f=l.phoneNo;return nt.a.trackEvent(this,{action:"StatusReport",id:234},{status:{result:"Success",event:{action:"SignUp",element:"Button"}},account:{phone:""+p+f,type:"Zhihu"}}),void(i?location.href=i:o?location.href="/":location.reload())}if(!a&&u||r!==c&&!1===c){var h={};!a&&u&&(h={smsInputInterceptTime:Date.now(),smsBackUpDisplay:!0},this.captchaValidated=!1),this.setState(Ft({},h,{validationResult:{message:a,needsRefresh:!0,timestamp:Date.now()}}))}!n&&s&&this.setState({smsInputInterceptTime:Date.now(),validationResult:{message:s,needsRefresh:Boolean(s),timestamp:Date.now()}})}},{key:"render",value:function(){var e=this,t=this.state,n=t.phoneNo,r=t.smsType,a=t.password,o=t.reStartTime,i=t.digitsValidated,s=t.validationResult,c=t.smsBackUpDisplay,u=t.customErrorInputMap,l=t.smsInputInterceptTime,p=this.props,f=p.sendDigitsError,h=p.onSetShowHeader,d=this.parseErrorMessages(),m=d.phoneNoError,g=d.fullnameError,y=d.passwordError,v=d.usernameError,b=u.phoneNoError,w=u.digitsError;return Qe.a.createElement("div",{className:"Register"},i?Qe.a.createElement("div",{className:"Register-padName"},Qe.a.createElement("div",{className:"Register-padNameHeader"},Qe.a.createElement(at.default,{onClick:function(){e.setState({digitsValidated:!1},function(){h(!0)})}},Qe.a.createElement(ot.ArrowLeft,{size:30})),Qe.a.createElement("span",{className:"Register-padNameTitle"},"设置用户名和密码")),Qe.a.createElement(lt.b,{onSubmit:this.handleSubmit},Qe.a.createElement(Ut,{name:"fullname",placeholder:"用户名",onChange:this.handleChange("fullname"),manualValidateError:g}),Qe.a.createElement(Bt,{defaultValue:a,onChange:this.handleChange("password"),manualValidateError:y}),Qe.a.createElement(at.default,{className:"Register-getIn",type:"submit",preset:"primary",color:"blue"},"进入知乎"))):Qe.a.createElement("div",null,Qe.a.createElement("div",{className:"Register-content"},Qe.a.createElement(lt.b,{onSubmit:this.handleValidateDigits},Qe.a.createElement(jt.a,{type:"register",onChange:this.handleChange("phoneNo"),onSelect:this.handleChange("selectedCountry"),manualValidateError:m||b||v}),Qe.a.createElement(Pt,{className:"SignFlow-captchaContainer Register-captcha",type:"register",isChinese:this.captchaIsChinese,canCaptchaShown:Boolean(n),onUpdateInput:this.handleChange("captcha"),validationResult:s}),Qe.a.createElement("div",{className:"Register-SMSInput"},Qe.a.createElement(_t.a,{smsType:r,reStartTime:o,onChange:this.handleChange("digits"),countDownEvent:this.handleSendDigits,countDownEndEvent:this.handleCountDownEndEvent,interceptTime:l,manualValidateError:w||f}),Qe.a.createElement("div",{className:Ge()("Register-smsBackUp",{"Register-hiddenSmsBackUp":!c})},Qe.a.createElement("span",{onClick:this.handleBackUpDigits},"接收","text"===r?"语音":"短信","验证码"))),Qe.a.createElement(at.default,{className:"Register-submitButton",preset:"primary",color:"blue",type:"submit"},i?"进入知乎":"注册")),Qe.a.createElement("div",{className:"Register-footer"},Qe.a.createElement("span",{className:"Register-declaration"},"注册即代表同意",Qe.a.createElement("a",{href:"https://www.zhihu.com/terms"},"《知乎协议》"),Qe.a.createElement("a",{href:"https://www.zhihu.com/terms/privacy"},"《隐私政策》")),Qe.a.createElement("a",{className:"Register-org",href:"https://www.zhihu.com/org/signup"},"注册机构号")))))}}]),t}(ze.Component))||ke)||ke),zt=n(176),Qt=(n(1228),function(e){var t=e.isSignIn,n=e.isInSignPage;return Qe.a.createElement("div",{className:"SignFlowHeader",style:n?{paddingBottom:"5px"}:{}},Qe.a.createElement(zt.a,{zoom:n?2.1875:1.53125}),Qe.a.createElement("div",{className:"SignFlowHeader-slogen"},t?"登录":"注册","知乎，发现更大的世界"))}),Yt=(n(889),n(1229),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}),Xt=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Kt=function(e){var t=e.captcha,n=t.captchaNeeded,r=t.captchaValidationMessage,a=e.register;return{captchaNeeded:n,registerValidateErrors:a.registerValidateErrors,captchaValidationMessage:r,registerConfirmSucceeded:a.registerConfirmSucceeded}},Zt={phoneNoError:null,fullnameError:null,passwordError:null,digitsError:null},Gt=(Object(et.connect)(Kt,{checkCaptcha:ut.b,validateAndRegister:ct.e,resetRegisterValidateResult:ct.c})(Te=function(e){function t(){var e,n,r,a;j(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=r=_(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.state={email:"",password:"",fullname:"",captcha:"",customErrorInputMap:Yt({},Zt)},r.handleChange=function(e){return function(t){r.setState(P({},e,t))}},r.runBeforeCheckCaptcha=function(e){var t=r.state.captcha,n=r.props,a=n.captchaNeeded,o=n.checkCaptcha;if(!r.captchaValidated&&a)return t?void o(t).then(function(t){t.payload.success&&(r.captchaValidated=!0,e())}):void r.setState({validationResult:{message:"请输入验证码",needsRefresh:!1,timestamp:Date.now()},smsInputInterceptTime:Date.now()});e()},r.handleSubmit=function(){r.runBeforeCheckCaptcha(function(){var e=r.props,t=e.validateAndRegister;(0,e.resetRegisterValidateResult)();var n=r.state;t({source:"com.zhihu.web",registerType:"email",email:n.email,password:n.password,fullname:n.fullname})})},a=n,_(r,a)}return R(t,e),Xt(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.captchaValidationMessage,r=t.registerConfirmSucceeded,a=e.captchaValidationMessage,o=e.registerConfirmSucceeded;!r&&o&&(location.href="/"),!n&&a&&this.setState({smsInputInterceptTime:Date.now(),validationResult:{message:a,needsRefresh:Boolean(a),timestamp:Date.now()}})}},{key:"render",value:function(){var e=this.state.validationResult,t=this.props.registerValidateErrors,n=t.email;n=void 0===n?{}:n;var r=n.message,a=t.fullname;a=void 0===a?{}:a;var o=a.message,i=t.password;i=void 0===i?{}:i;var s=i.message;return Qe.a.createElement(lt.b,{className:"SignContainer-content EmailRegister",onSubmit:this.handleSubmit},Qe.a.createElement(Qt,null),Qe.a.createElement(Ut,{onChange:this.handleChange("fullname"),name:"fullname",placeholder:"用户名",manualValidateError:o}),Qe.a.createElement(jt.a,{type:"register",placeholder:"输入邮箱",onChange:this.handleChange("email"),manualValidateError:r,supportedCountriesShown:!1}),Qe.a.createElement(Bt,{onChange:this.handleChange("password"),manualValidateError:s}),Qe.a.createElement(Pt,{className:"SignFlow-captchaContainer Register-captcha",type:"register",isChinese:this.captchaIsChinese,canCaptchaShown:!0,onUpdateInput:this.handleChange("captcha"),validationResult:e}),Qe.a.createElement(at.default,{className:"EmailRegister-submitButton",preset:"primary",color:"blue",type:"submit"},"注册"))}}]),t}(ze.Component)),n(167)),$t=n(12),Jt=n(1230),en=n.n(Jt),tn=n(169),nn=n.n(tn),rn=(n(170),n(111),Object.assign,nn()("zhihu-redux-middlewares:oauth"),"c3cef7c66a1843f8b3a9e6a1e3160e20"),an=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},on=I,sn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},cn=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),un={phoneNoError:null,fullnameError:null,digitsError:null},ln=function(e){var t=e.captcha,n=t.captchaNeeded,r=t.captchaValidationMessage,a=e.register,o=a.registerConfirmError,i=a.registerValidateErrors,s=a.registerConfirmSucceeded,c=e.login,u=c.loginConfirmSucceeded,l=c.validateDigitsError,p=c.loginConfirmError;return{captchaNeeded:n,sendDigitsError:c.sendDigitsError,registerConfirmError:o,registerValidateErrors:i,captchaValidationMessage:r,registerConfirmSucceeded:s,loginConfirmSucceeded:u,validateDigitsError:l,loginConfirmError:p,edition:e.env.edition}},pn=(Ne=Object(et.connect)(ln,{showNotification:$t.g,checkCaptcha:ut.b,validateDigits:Gt.i,sendLoginDigits:Gt.g,validateAndLogin:Gt.h,validateAndRegister:ct.e,validateRegisterForm:ct.h,resetLoginValidateResult:Gt.f,resetRegisterValidateResult:ct.c}))(Pe=function(e){function t(){var e,n,r,a;A(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=r=B(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.state={fullname:"",phoneNo:"",digits:"",captcha:"",isRegister:null,smsBackUpDisplay:!0,smsType:"text",selectedCountry:{name:"中国",code:"+86"},smsInputInterceptTime:-1,reStartTime:-1,customErrorInputMap:sn({},un),validationResult:{}},r.captchaIsChinese=Math.random()<.5,r.testPhoneNo=function(){var e=r.state,t=e.selectedCountry.code,n=e.phoneNo,a=/^\d{11}$/;return"+86"!==t||a.test(n)},r.handleChange=function(e){return function(t){r.setState(D({},e,t))}},r.handleBackUpDigits=function(){r.setState({smsType:"text"===r.state.smsType?"voice":"text",reStartTime:Date.now()})},r.handleCountDownEndEvent=function(){r.setState({smsBackUpDisplay:!0})},r.parseServerError=function(e){var t=e||r.props,n=t.showNotification,a=t.registerValidateErrors,o=t.loginConfirmError,i=t.registerConfirmError,s=t.sendDigitsError,c=o||{},u=c.username,l=c.password,p=c.digits,f=c.captcha,h=i||{},d=h.username,m=h.password,g=h.digits,y=h.undefined;y&&n(y,"red");var v=s||{},b=v.username,w=v.captcha,E=a||{},S=E.fullname;S=void 0===S?{}:S;var C=S.message;return{usernameServerError:u||b,passwordServerError:l||m,digitsServerError:p||g,captchaServerError:f||w,fullnameServerError:C||d}},r.runBeforeCheckCaptcha=function(e){var t=r.state.captcha,n=r.props,a=n.captchaNeeded,o=n.checkCaptcha;if(!r.captchaValidated&&a)return t?void o(t,"register",r.captchaIsChinese?"cn":"en").then(function(t){t.payload.success&&(r.captchaValidated=!0,e())}):void r.setState({validationResult:{message:r.captchaIsChinese?"请点击图中倒立的文字":"请输入验证码",needsRefresh:!1,timestamp:Date.now()},smsInputInterceptTime:Date.now()});e()},r.runBeforeResetValidateResult=function(e){r.setState({customErrorInputMap:sn({},un),validationResult:{needsRefresh:!1,timestamp:Date.now()}},function(){e()})},r.handleSendDigits=function(){var e=r.state.phoneNo;if(!e||!r.testPhoneNo())return void r.setState({customErrorInputMap:sn({},r.state.customErrorInputMap,{phoneNoError:e?"请输入正确的手机号":"请输入手机号"}),smsInputInterceptTime:Date.now()});r.runBeforeCheckCaptcha(function(){r.runBeforeCheckCaptcha(r.sendDigits)})},r.sendDigits=function(){var e=r.state,t=e.selectedCountry,n=e.phoneNo,a=e.smsType,o=r.props.sendLoginDigits;r.props.validateRegisterForm({phoneNo:""+t.code+n}).then(function(e){var i=e.payload;r.setState({smsBackUpDisplay:!1,isRegister:!(i.phoneNo&&i.phoneNo.code===st.i)}),o(""+t.code+n,a)})},r.handleSumbit=function(){r.runBeforeCheckCaptcha(function(){r.runBeforeResetValidateResult(function(){var e=r.state,t=e.selectedCountry,n=e.phoneNo,a=e.digits,o=e.isRegister,i=e.fullname,s=r.props,c=s.defaultFullname,u=s.validateAndLogin,l=s.validateAndRegister,p=s.edition,f=s.nextUrl,h=Object(rt.extractSource)(f,p);if(o)return void l(sn({source:"com.zhihu.web",registerType:"phone_digits",phoneNo:""+t.code+n,fullname:i||c,digits:a},h));u(on("digits",sn({username:""+t.code+n,digits:a},h)))})})},a=n,B(r,a)}return M(t,e),cn(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.nextUrl,r=t.isInSignPage,a=t.sendDigitsError,o=t.loginConfirmError,i=t.loginConfirmSucceeded,s=t.registerConfirmSucceeded,c=t.captchaValidationMessage,u=e.sendDigitsError,l=e.loginConfirmError,p=e.loginConfirmSucceeded,f=e.registerConfirmSucceeded,h=e.captchaValidationMessage;if(!i&&p||!s&&f)return void(n?location.href=n:r?location.href="/":location.reload());if(!o&&l&&l.validateDigitsError&&this.setState({customErrorInputMap:sn({},this.state.customErrorInputMap,{digitsError:l.validateDigitsError}),smsInputInterceptTime:Date.now()}),!a&&u){var d=this.parseServerError(e),m=d.captchaServerError;this.setState({validationResult:{message:m,needsRefresh:!0,timestamp:Date.now()},smsInputInterceptTime:Date.now()})}!c&&h&&this.setState({smsInputInterceptTime:Date.now(),validationResult:{message:h,needsRefresh:Boolean(h),timestamp:Date.now()}})}},{key:"render",value:function(){var e=this.state,t=e.smsInputInterceptTime,n=e.customErrorInputMap,r=e.smsBackUpDisplay,a=e.validationResult,o=e.reStartTime,i=e.isRegister,s=e.phoneNo,c=e.smsType,u=this.props,l=u.onResetRegister,p=u.defaultFullname,f=n.phoneNoError,h=n.digitsError,d=this.parseServerError(),m=d.usernameServerError,g=d.fullnameServerError,y=d.digitsServerError;return Qe.a.createElement(lt.b,{className:"Register-content",onSubmit:this.handleSumbit},Qe.a.createElement("div",{className:"Register-socialHeader",key:"header"},Qe.a.createElement("div",{className:"Register-socialTitle"},Qe.a.createElement(at.default,{onClick:l},Qe.a.createElement(ot.ArrowLeft,{size:30})),"验证手机"),Qe.a.createElement("span",{className:"Register-socialSubTitle"},"请输入你的手机号和 6 位短信验证码")),Qe.a.createElement(Ut,{className:Ge()("Register-socialName",{"Register-hiddenSocialName":!i}),name:"fullname",key:"fullname",placeholder:"用户名",defaultValue:p,onChange:this.handleChange("fullname"),manualValidateError:g}),Qe.a.createElement(jt.a,{type:"register",onChange:this.handleChange("phoneNo"),onSelect:this.handleChange("selectedCountry"),manualValidateError:f||m}),Qe.a.createElement(Pt,{className:"SignFlow-captchaContainer",type:"register",isChinese:this.captchaIsChinese,canCaptchaShown:Boolean(s),onUpdateInput:this.handleChange("captcha"),validationResult:a}),Qe.a.createElement(_t.a,{smsType:c,reStartTime:o,onChange:this.handleChange("digits"),countDownEvent:this.handleSendDigits,countDownEndEvent:this.handleCountDownEndEvent,interceptTime:t,manualValidateError:h||y}),Qe.a.createElement("div",{className:Ge()("Register-smsBackUp",{"Register-hiddenSmsBackUp":!r})},Qe.a.createElement("span",{onClick:this.handleBackUpDigits},"接收","text"===c?"语音":"短信","验证码")),Qe.a.createElement(at.default,{className:"Register-submitButton",type:"submit",preset:"primary",color:"blue"},"进入知乎"))}}]),t}(ze.Component))||Pe,fn=Wt,hn=n(17),dn=V,mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gn={sina:"Weibo",qq:"QQ",wechat:"Wechat"},yn=n(288),vn=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),bn="/oauth/account_callback",wn={qq:"/oauth/redirect/login/qqconn?next=",sina:"/oauth/redirect/login/sina?next=",wechat:"/oauth/redirect/login/wechat?next="},En=(_e=je=function(e){function t(){var e,n,r,a;H(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=r=W(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.state={socialButtonExpanded:!1},r.accountCallback=function(e){var t=r.props,n=t.onRegister,a=t.nextUrl,o=e.login,i=e.type,s=e.fullname;o?(Object(yn.b)(r.clickedServiceName),r.handleLogSocialLoginSuccess(),a?location.href=a:location.reload()):n({bySocial:!0,socialType:i,fullname:s})},r.handleBuildSocialAuthLink=function(e){r.clickedServiceName=e,r.handleLogSingleSocialButtonClick(e),window.NWEB={accountCallback:r.accountCallback},document.domain="zhihu.com";var t=wn[e],n="sina"!==e,a=r.props,o=a.nextUrl,i=a.edition,s=Object(rt.extractSource)(o,i),c=s.utmSource,u=s.refSource;n?window.open("https://www.zhihu.com"+t+bn+(c?"&utm_source="+c:"")+"&ref_source="+u,"_blank","top=200,left=400,width=600,height=550,directories=no,menubar=no,toolbar=no"):location.href=""+t+bn+"&from="+encodeURIComponent(r.parseNextInfoFromUrl())},r.handleChangeSocialButtonState=function(){r.handleLogSocialLogin(),r.setState(function(e){return{socialButtonExpanded:!e.socialButtonExpanded}})},r.parseNextInfoFromUrl=function(){var e=r.props.router.location.query.next,t="/";if(e)try{t=decodeURIComponent(e)}catch(n){t=unescape(e)}return t},a=n,W(r,a)}return z(t,e),vn(t,[{key:"componentWillUnmount",value:function(){window.NWEB&&"www.zhihu.com"===location.host&&(document.domain="www.zhihu.com",delete window.NWEB)}},{key:"handleLogSocialLogin",value:function(){nt.a.trackEvent(this,{action:"Click",element:"Button",element_name:"SNSSignIn"})}},{key:"handleLogSingleSocialButtonClick",value:function(e){F(this,"SignIn",{type:gn[e]})}},{key:"handleLogSocialLoginSuccess",value:function(){L(this,"SignIn",this.clickedServiceName)}},{key:"render",value:function(){var e=this,t=this.state.socialButtonExpanded;return Qe.a.createElement("span",{className:"Login-socialLogin"},Qe.a.createElement(at.default,{preset:"plain",onClick:this.handleChangeSocialButtonState,className:Ge()("Login-socialButtonEntrance",{"Login-socialButtonEntrance--hidden":t})},"社交帐号登录"),Qe.a.createElement("span",{className:Ge()("Login-socialButtonGroup",{"Login-socialButtonGroup--hidden":!t})},Qe.a.createElement(at.default,{preset:"plain",className:"Login-socialButton",onClick:function(){return e.handleBuildSocialAuthLink("wechat")},disabled:!t},Qe.a.createElement(ft.a,{name:"wechat",className:"Login-socialIcon",width:18,height:17})),Qe.a.createElement(at.default,{preset:"plain",className:"Login-socialButton",onClick:function(){return e.handleBuildSocialAuthLink("sina")},disabled:!t},Qe.a.createElement(ft.a,{name:"weibo",className:"Login-socialIcon",width:20,height:16})),Qe.a.createElement(at.default,{preset:"plain",className:"Login-socialButton",onClick:function(){return e.handleBuildSocialAuthLink("qq")},disabled:!t},Qe.a.createElement(ft.a,{name:"qq",className:"Login-socialIcon",width:17,height:19}))))}}]),t}(ze.Component),je.propTypes={onRegister:Ke.a.func.isRequired,edition:Ke.a.object},_e),Sn=En,Cn=n(74),On=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),kn=(Re=Object(et.connect)(K,{getQrcodeLoginToken:Gt.d,checkQrcodeScanStatus:Gt.a,getReQesXUDID:Gt.e}))(Ie=Object(hn.withRouter)((Ae=De=function(e){function t(e){Q(this,t);var n=Y(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.cancelCheckQrcodeScanStatus=function(){n.timer&&window.clearInterval(n.timer)},n.checkQrcodeScanStatus=function(e){var t=n.props.checkQrcodeScanStatus;n.timer=setInterval(function(){t({token:e})},2e3)},n.handleChangeStauts=function(e,t){n.setState({stauts:e}),"init"!==e||t||n.getToken()},n.handleChangeLoginType=function(){var e=n.props.onChangeType;n.cancelCheckQrcodeScanStatus(),e()},n.state={type:"password",stauts:"init",errorMessage:""},n}return X(t,e),On(t,[{key:"componentDidMount",value:function(){this.getToken()}},{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.qrcodeLoginToken,r=t.qrcodeLoginScanStatus,a=e.qrcodeLoginToken,o=e.qrcodeLoginScanStatus,i=e.qrcodeLoginError,s=e.qrcodeLoginReturnNewToken;""!==a&&n!==a?(this.cancelCheckQrcodeScanStatus(),"init"!==this.state.stauts&&this.handleChangeStauts("init",!0),this.checkQrcodeScanStatus(a)):r!==o?2!==o&&this.handleChangeStauts(1===o?"success":"init",s||1===r&&0===o):i&&i.code&&(this.cancelCheckQrcodeScanStatus(),40321===i.code&&this.setState({stauts:"error",errorMessage:i.message}))}},{key:"componentWillUnmount",value:function(){this.cancelCheckQrcodeScanStatus()}},{key:"getToken",value:function(){var e=this,t=this.props,n=t.getQrcodeLoginToken,r=t.getReQesXUDID,a=t.token;a&&a.xUDID||this.reQesXUDID?n():r().then(function(){e.reQesXUDID=!0,n()})}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.isShowPasswordLogin,a=t.qrcodeLoginToken,o=this.state,i=o.stauts,s=o.errorMessage;return"init"===i?Qe.a.createElement("div",{className:Ge()("Qrcode-container",n)},Qe.a.createElement("div",{className:"Qrcode-content"},Qe.a.createElement("div",{className:"Qrcode-img"},a?Qe.a.createElement("img",{width:"150",height:"150",src:"https://account.zhihu.com/api/login/qrcode/"+a+"/image",alt:"二维码"}):Qe.a.createElement(Cn.a,{count:3})),Qe.a.createElement("p",null,"打开",Qe.a.createElement("a",{href:"https://www.zhihu.com/app/",target:"_blank",rel:"noopener noreferrer"}," ","知乎 App")),Qe.a.createElement("p",null,"在「我的」页面右上角打开扫一扫")),!1!==r&&Qe.a.createElement("div",{className:"Qrcode-cutButton"},Qe.a.createElement("span",{onClick:function(){return e.handleChangeLoginType()}},"使用密码登录"))):"success"===i?Qe.a.createElement("div",{className:Ge()("Qrcode-container",n)},Qe.a.createElement("div",{className:"Qrcode-content"},Qe.a.createElement("div",{className:"Qrcode-scanResultStaus"},Qe.a.createElement(ft.a,{name:"success",fill:"#2db370",width:58,height:58})),Qe.a.createElement("p",{className:"Qrcode-scanResultTips"},"扫描成功"),Qe.a.createElement("p",null,"请在手机上「确认登录」")),Qe.a.createElement("div",{className:"Qrcode-cutButton"},Qe.a.createElement("span",{onClick:function(){return e.handleChangeStauts("init")}},"返回二维码"))):Qe.a.createElement("div",{className:Ge()("Qrcode-container",n)},Qe.a.createElement("div",{className:"Qrcode-content Qrcode-failure"},Qe.a.createElement("div",null,Qe.a.createElement(ft.a,{name:"failure",fill:"#ffaa00",width:58,height:58})),Qe.a.createElement("p",null,s)),!1!==r&&Qe.a.createElement("div",{className:"Qrcode-cutButton"},Qe.a.createElement("span",{onClick:function(){return e.handleChangeLoginType()}},"使用密码登录")))}}]),t}(ze.Component),De.propTypes={type:Ke.a.string,isShowPasswordLogin:Ke.a.bool,onChangeType:Ke.a.func,getQrcodeLoginToken:Ke.a.func,checkQrcodeScanStatus:Ke.a.func},De.defaultProps={qrcodeLoginToken:"",qrcodeLoginScanStatus:""},Ie=Ae))||Ie)||Ie,Tn=kn,Nn=(n(1231),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}),Pn=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),jn={username:null,password:null,captcha:null,digits:null},_n=Qe.a.createElement("div",{className:"SignFlow-snackBar"},Qe.a.createElement("span",{className:"Login-accountBlockEmphasis"},"帐号已停用。"),Qe.a.createElement("span",null,"如有疑问，请发邮件至"),Qe.a.createElement("a",{className:"SignFlow-snackBarLink",href:"mailto:i@zhihu.com"}," i@zhihu.com "),Qe.a.createElement("span",null,"联系管理员")),Rn=(Be=Object(et.connect)(ee,{confirmLogin:Gt.b,resetLoginValidateResult:Gt.f,validateSendDigits:Gt.j,showNotification:$t.g,checkCaptcha:ut.b}),Me=Object(it.a)(te),Be(Ve=Object(hn.withRouter)(Ve=Me((Ue=xe=function(e){function t(e){G(this,t);var n=$(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));Fe.call(n);var r=e.selectedCountry,a=e.username,o=e.password;return n.state={smsType:"text",smsBackUpName:"语音",smsBackUpDisplay:!0,reStartTime:-1,supportedCountriesShown:!1,captcha:"",selectedCountry:r,username:a,password:o,customErrorInputMap:Nn({},jn),validationResult:{},smsInputInterceptTime:-1},n.captchaIsChinese=Math.random()<.5,n}return J(t,e),Pn(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.sendDigitsError,r=t.captchaValidationMessage,a=t.loginConfirmSucceeded,o=t.loginConfirmError,i=t.isInSignPage,s=t.nextUrl,c=e.sendDigitsError,u=e.captchaValidationMessage,l=e.loginConfirmSucceeded,p=e.loginConfirmError,f=e.onShowExtraInfo;if(!n&&c||a!==l&&!1===l){var h=!n&&c?{smsInputInterceptTime:Date.now()}:{},d=this.parseServerError(e),m=d.captchaServerError;this.setState(Nn({},h,{validationResult:{message:m,needsRefresh:!0,timestamp:Date.now()}})),this.handleLogSubmitValidateError(c||p),!p||!p.extra||o&&o.extra===p.extra||f(_n)}else if(r!==u){var g=u?{smsInputInterceptTime:Date.now()}:{};this.setState(Nn({validationResult:{message:u,needsRefresh:Boolean(u),timestamp:Date.now()}},g)),u&&this.handleLogSubmitValidateError(u)}else!a&&l&&(Object(yn.b)(this.state.username),this.handleLogSubmitSuccess(),s?location.href=s:i?location.href="/":location.reload());(u||(n||c)&&null===p)&&this.handleCountDownEndEvent()}},{key:"componentWillUnmount",value:function(){this.props.resetLoginValidateResult()}},{key:"buildZAAccount",value:function(){var e=this.state,t=e.username,n=e.selectedCountry.code,r=U(t,n),a=r.value,o=r.isEmail;return{email:o&&a?a:null,phone:o||!a?null:a,type:"Zhihu"}}},{key:"handleLogSubmitSuccess",value:function(){L(this,"SignIn",this.buildZAAccount(),"digits"===this.props.type?"SMSSignIn":null)}},{key:"render",value:function(){var e=this,t=this.props,n=t.onSwitch,r=t.type,a=t.passwordType,o=t.nextUrl,i=t.edition,s=t.router,c=this.state,u=c.supportedCountriesShown,l=c.selectedCountry,p=c.username,f=c.password,h=c.validationResult,d=c.smsType,m=c.smsBackUpName,g=c.smsBackUpDisplay,y=c.customErrorInputMap.username,v=c.smsInputInterceptTime,b=c.reStartTime,w=this.parseServerError(),E=w.usernameServerError,S=w.passwordServerError,C=w.digitsServerError,O=!this.captchaValidated&&Qe.a.createElement(Pt,{className:"SignFlow-captchaContainer",canCaptchaShown:this.checkAllInputFilled(),type:"digits"===r?"digitsLogin":"login",isChinese:this.captchaIsChinese,onUpdateInput:function(t){return e.handleChange("captcha",t)},validationResult:h});return"qrcode"===r?Qe.a.createElement(Tn,{className:"SignInQrcode",onChangeType:function(){return e.handleChangeType("password")}}):Qe.a.createElement(lt.b,{className:"SignFlow",onSubmit:this.handleSubmit,onPreSubmit:this.handleLogSubmit,onInvalid:this.handleLogSubmitValidateError},Qe.a.createElement(jt.a,{type:"digits"===r||u?"digits":"password",supportedCountriesShown:"digits"===r||"oversea"===a,onChange:function(t){return e.handleChange("username",t)},onSelect:function(t){return e.handleChange("selectedCountry",t)},defaultSelectedCountry:l,manualValidateError:E||y,defaultValue:p}),"digits"===r&&O,"digits"===r&&Qe.a.createElement(_t.a,{countDownEvent:function(){return e.handleSendDigits()},countDownEndEvent:this.handleCountDownEndEvent,interceptTime:v,manualValidateError:C,smsType:d,reStartTime:b}),"password"===r&&Qe.a.createElement(Bt,{onChange:function(t){return e.handleChange("password",t)},manualValidateError:S,defaultValue:f}),"password"===r&&O,Qe.a.createElement("div",{className:"Login-options"},Qe.a.createElement(at.default,{preset:"plain",className:"Login-switchType",onClick:function(){e.handleChangeType("digits"===r?"password":"digits")}},"digits"===r?"密码登录（手机号或邮箱）":"手机验证码登录"),Qe.a.createElement(at.default,{preset:"plain",className:"Login-cannotLogin",onClick:"digits"===r?this.handleChangeSmsType:this.handleResetPassword},"digits"===r?g&&"接收"+m+"验证码":"忘记密码？")),Qe.a.createElement(at.default,{type:"submit",className:"SignFlow-submitButton",preset:"primary",color:"blue"},"登录"),Qe.a.createElement("div",{className:"Login-footer"},Qe.a.createElement("span",{className:"Login-qrcode"},Qe.a.createElement(at.default,{preset:"plain",onClick:function(){return e.handleChangeType("qrcode")}},"二维码登录")),Qe.a.createElement("span",{className:"Login-footerSeparate Login-qrcodeSeparate"}," · "),Qe.a.createElement("span",{className:"Login-aboardPhone"},Qe.a.createElement(at.default,{preset:"plain",onClick:function(){e.handleChangeType("email"===a?"oversea":"email")}},"email"===a?"海外手机登录":"邮箱帐号登录")),Qe.a.createElement("span",{className:"Login-footerSeparate"}," · "),Qe.a.createElement(Sn,{nextUrl:o,edition:i,onRegister:n,router:s})))}}]),t}(ze.Component),xe.propTypes={confirmLogin:Ke.a.func,resetLoginValidateResult:Ke.a.func,validateSendDigits:Ke.a.func,loginConfirmSucceeded:Ke.a.bool,loginConfirmError:Ke.a.object,sendDigitsError:Ke.a.object,captchaValidationMessage:Ke.a.string,captchaNeeded:Ke.a.bool,edition:Ke.a.object,onSwitch:Ke.a.func,onShowExtraInfo:Ke.a.func,selectedCountry:Ke.a.object,username:Ke.a.string,password:Ke.a.string,type:Ke.a.oneOf(["password","digits","qrcode"]),onChangeType:Ke.a.func},xe.defaultProps={selectedCountry:{name:"中国",code:"+86"},username:"",password:""},Fe=function(){var e=this;this.checkAllInputFilled=function(){if(e.allInputFilled)return e.allInputFilled;var t=e.props.type,n=e.state,r=n.username,a=n.password;return e.allInputFilled="digits"===t?Boolean(r):Boolean(r)&&Boolean(a),e.allInputFilled},this.handleChange=function(t,n){e.setState(Z({},t,n))},this.handleChangeType=function(t){var n=e.props,r=n.type,a=n.onChangeType;(0,n.resetLoginValidateResult)(),a(t),"qrcode"!==t&&"password"!==t||nt.a.trackEvent(e,{action:"Click",name:"qrcode"===t?"使用二维码登录":"使用密码登录"},{account:{type:"Zhihu"}}),"qrcode"!==t&&(e.setState(function(e){var t=e.username;return{username:"password"===r&&dn(t)?"":t,smsBackUpDisplay:!0}}),nt.a.trackEvent(e,{action:"Switch",element:"Button"},{account:{type:"Zhihu"}}))},this.handleChangeSmsType=function(){e.setState(function(e){var t=e.smsType;return{smsType:"text"===t?"voice":"text",smsBackUpName:"text"===t?"短信":"语音",reStartTime:Date.now()}})},this.handleCountDownEndEvent=function(){e.setState({smsBackUpDisplay:!0})},this.testPhoneNo=function(){var t=e.state,n=t.selectedCountry.code,r=t.username,a=/^\d{11}$/;return"+86"!==n||a.test(r)},this.handleSendDigits=function(){e.runBeforeResetValidateResult(function(){var t=e.props,n=t.validateSendDigits,r=t.captchaNeeded,a=t.resetLoginValidateResult,o=e.state,i=o.username,s=o.selectedCountry.code,c=o.captcha,u=o.customErrorInputMap,l=o.validationResult,p=o.smsType;if(a(),!e.testPhoneNo())return void e.setState({customErrorInputMap:Nn({},e.state.customErrorInputMap,{username:i?"请输入正确的手机号":"请输入手机号"}),smsInputInterceptTime:Date.now()});if(i&&(!r||c)){return n({username:U(i,s).value,captcha:c,smsType:p,type:"login",lang:e.captchaIsChinese?"cn":"en"}),void e.setState({smsBackUpDisplay:!1})}var f=r&&!c?{message:e.captchaIsChinese?"请点击图中倒立的文字":"请输入验证码",needsRefresh:!1,timestamp:Date.now()}:Nn({},l);e.setState({customErrorInputMap:Nn({},u,{username:i?"":"请输入手机号"}),smsInputInterceptTime:Date.now(),validationResult:f}),e.handleLogSubmitValidateError({username:i?"":"请输入手机号",captcha:r&&!c?"请输入验证码":""})})},this.handleSupportedCountriesShown=function(t){e.setState(function(e){var n=e.supportedCountriesShown;return{supportedCountriesShown:t||!n}})},this.runBeforeResetValidateResult=function(t){e.props.resetLoginValidateResult(),e.setState({customErrorInputMap:Nn({},jn),validationResult:{needsRefresh:!1,timestamp:Date.now()}},function(){t()})},this.runBeforeCheckCaptcha=function(t){var n=e.state.captcha,r=e.props,a=r.captchaNeeded,o=r.checkCaptcha;if(!e.captchaValidated&&a)return n?void o(n,"register",e.captchaIsChinese?"cn":"en").then(function(n){n.payload.success&&(e.captchaValidated=!0,t())}):void e.setState({validationResult:{message:e.captchaIsChinese?"请点击图中倒立的文字":"请输入验证码",needsRefresh:!1,timestamp:Date.now()},smsInputInterceptTime:Date.now()});t()},this.handleSubmit=function(t){e.runBeforeResetValidateResult(function(){var n=e.props,r=n.type,a=n.passwordType;if(("digits"===r||"oversea"===a)&&!e.testPhoneNo())return void e.setState({customErrorInputMap:Nn({},e.state.customErrorInputMap,{username:e.state.username?"请输入正确的手机号":"请输入手机号"}),smsInputInterceptTime:Date.now()});e.runBeforeCheckCaptcha(function(){var n=e.props,r=n.confirmLogin,a=n.type,o=n.nextUrl,i=n.edition,s=e.state,c=s.selectedCountry,u=s.captcha,l=Object(rt.extractSource)(o,i),p=Nn({},t,{username:U(t.username,c.code).value,captcha:u,lang:e.captchaIsChinese?"cn":"en"},l);r(on(a,p))})})},this.parseServerError=function(t){var n=t||e.props,r=n.loginConfirmError,a=n.sendDigitsError,o=n.showNotification,i=r||{},s=i.username,c=i.password,u=i.digits,l=i.captcha,p=i.undefined,f=a||{},h=f.username,d=f.undefined;return(p||d)&&o(p||d,"red"),{usernameServerError:s||h,passwordServerError:c,digitsServerError:u,captchaServerError:l}},this.handleResetPassword=function(){var t=e.props.onClose;nt.a.trackEvent(e,{action:"Click",element:"Button",element_name:"ResetPassword"}),t&&t(),window.open("/account/password_reset","_blank")},this.handleLogSubmit=function(){F(e,"SignIn",e.buildZAAccount(),"digits"===e.props.type?"SMSSignIn":null)},this.handleLogSubmitValidateError=function(t){q(e,"SignIn",e.buildZAAccount(),t,"digits"===e.props.type?"SMSSignIn":null)}},Ve=Ue))||Ve)||Ve)||Ve),In=Rn,Dn=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),An=(qe=Le=function(e){function t(){var e,n,r,a;ne(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=r=re(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.state={type:"password",passwordType:"email"},r.handleSwitchLoginType=function(e){if("email"===e||"oversea"===e)return void r.setState({type:"password",passwordType:e});r.setState({type:e})},a=n,re(r,a)}return ae(t,e),Dn(t,[{key:"render",value:function(){var e=this.props,t=e.nextUrl,n=e.onSwitch,r=e.isInSignPage,a=this.state,o=a.type,i=a.passwordType;return Qe.a.createElement("div",{className:"Login-content"},Qe.a.createElement(In,{type:o,isInSignPage:r,passwordType:i,onChangeType:this.handleSwitchLoginType,onSwitch:n,nextUrl:t}))}}]),t}(ze.Component),Le.propTypes={nextUrl:Ke.a.string,isInSignPage:Ke.a.bool,onSwitch:Ke.a.func},qe),Bn=An,Mn=Bn,Vn=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),xn=(We=He=function(e){function t(e){oe(this,t);var n=ie(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleChangeSignType=function(e){return function(){n.setState({signType:e,showHeader:!0})}},n.handleSetShowHeader=function(e){n.setState({showHeader:e})},n.handleSocialRegister=function(e){var t=e.fullname,r=e.socialType;n.setState({fullname:t,socialType:r,signType:"register",showHeader:!1})},n.handleResetRegister=function(){n.setState({fullname:"",socialType:"",signType:"login",showHeader:!0})},n.state={showHeader:!0,signType:e.signType||"login",fullname:"",socialType:""},n}return se(t,e),Vn(t,[{key:"componentDidMount",value:function(){var e=this.props.nextUrl,t=this.context.currentUser;t&&"guest"!==t.userType&&(location.href=e||"/")}},{key:"render",value:function(){var e=this.state,t=e.signType,n=e.showHeader,r=e.fullname,a=e.socialType,o=this.props,i=o.showQrcode,s=o.nextUrl,c=o.isInSignPage,u=a?Qe.a.createElement(pn,{nextUrl:s,isInSignPage:c,defaultFullname:r,onResetRegister:this.handleResetRegister}):[Qe.a.createElement(fn,{key:"register",nextUrl:s,isInSignPage:c,socialType:a,onChangeToSigin:this.handleChangeSignType("login"),onSetShowHeader:this.handleSetShowHeader}),Qe.a.createElement("div",{className:"SignContainer-switch",key:"switch"},"已有帐号？",Qe.a.createElement("span",{onClick:this.handleChangeSignType("login")},"登录"))];return Qe.a.createElement(Je,{className:"SignContainer-content"},n&&Qe.a.createElement(Qt,{isSignIn:"login"===t,isInSignPage:c}),Qe.a.createElement("div",{className:"SignContainer-inner"},"login"===t?[Qe.a.createElement(Mn,{key:"login",nextUrl:s,isInSignPage:c,onSwitch:this.handleSocialRegister}),Qe.a.createElement("div",{className:"SignContainer-switch",key:"switch"},"没有帐号？",Qe.a.createElement("span",{onClick:this.handleChangeSignType("register")},"注册"))]:u,Qe.a.createElement("div",{className:Ge()("SignFlowHomepage-qrImage",{"SignFlowHomepage-qrImageHidden":!i})},Qe.a.createElement("div",null))))}}]),t}(ze.Component),He.contextTypes={currentUser:Ke.a.object},We);n.d(t,"default",function(){return Fn});var Un=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Fn=function(e){function t(){return ce(this,t),ue(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return le(t,e),Un(t,[{key:"render",value:function(){var e=this.props,t=e.onClose,n=e.signType;return Qe.a.createElement(Ye.default,{className:"signFlowModal",onClose:t},Qe.a.createElement(xn,{signType:n}))}}]),t}(ze.Component)},1244:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){var t=e.active;return{sendDigitsError:t.sendDigitsError,activeConfirmSucceeded:t.activeConfirmSucceeded,activeConfirmError:t.activeConfirmError}}function c(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function f(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function g(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var w,E,S,C,O,k,T,N,P,j,_=n(1),R=n.n(_),I=n(0),D=n.n(I),A=n(4),B=n(3),M=n(293),V=n(39),x=n(798),U=n(803),F=n(821),L=(n(890),function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}()),q=(w=Object(A.connect)(s,{getUnlockTicketAndDigits:M.c,activeUserByEmail:M.a,validateAndActiveUserByDigits:M.d,activeUser:V.b}))((C=S=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.checkUserAccountType=function(e){return e.email?"email":"noInfo"},n.handleChange=function(e,t){n.setState(r({},e,t))},n.handleChangeSmsType=function(){n.setState(function(e){var t=e.smsType;return{smsType:"text"===t?"voice":"text",smsBackUpName:"text"===t?"短信":"语音",reStartTime:Date.now()}})},n.handleCountDownEndEvent=function(){n.setState({smsBackUpDisplay:!0})},n.handleSendDigits=function(){var e=n.props.getUnlockTicketAndDigits,t=n.state,r=t.selectedCountry.code,a=t.phoneNo,o=t.smsType;n.setState({manualError:null},function(){if(a)return e({newPhoneNo:""+r+a,smsType:o}),void n.setState({smsBackUpDisplay:!1});n.setState({manualError:"请输入手机号",smsInputInterceptTime:Date.now()})})},n.handleSubmit=function(e){var t=n.props,r=t.email,a=t.activeUserByEmail,o=t.validateAndActiveUserByDigits,i=t.onClose,s=n.state,c=s.accountType,u=s.selectedCountry.code,l=e.username,p=e.digits;"email"===c?(a({email:r}),"function"==typeof i&&i()):o({newPhoneNo:""+u+l,digits:p})},n.parseServerError=function(){var e=n.props,t=e.activeConfirmError,r=e.sendDigitsError,a=t||{},o=a.username,i=a.digits,s=r||{},c=s.username;return{usernameServerError:o||c,digitsServerError:i}},n.renderAccountInfo=function(){var e=n.props.email,t=n.state,r=t.accountType,a=t.manualError,o=n.parseServerError(),i=o.usernameServerError;return"noInfo"!==r?D.a.createElement("div",{className:"SignFlowActive-account"},e,"email"===r&&D.a.createElement("a",{target:"_blank",href:"/settings/account",className:"SignFlowActive-editEmail"},"修改邮箱")):D.a.createElement(U.a,{type:"digits",supportedCountriesShown:!0,manualValidateError:i||a,onSelect:function(e){return n.handleChange("selectedCountry",e)},onChange:function(e){return n.handleChange("phoneNo",e)}})},n.state={accountType:n.checkUserAccountType(e),selectedCountry:{code:"+86",name:"中国"},phoneNo:null,smsInputInterceptTime:-1,manualError:null,smsType:"text",smsBackUpName:"语音",smsBackUpDisplay:!0,reStartTime:-1},n}return i(t,e),L(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.sendDigitsError,r=t.onClose,a=t.activeUser,o=e.activeConfirmSucceeded,i=e.sendDigitsError;o?(r(),a()):!n&&i&&(this.setState({smsInputInterceptTime:Date.now()}),this.handleCountDownEndEvent())}},{key:"render",value:function(){var e=this.state,t=e.accountType,n=e.smsInputInterceptTime,r=e.smsType,a=e.smsBackUpName,o=e.smsBackUpDisplay,i=e.reStartTime,s=this.parseServerError(),c=s.digitsServerError;return D.a.createElement(x.b,{className:"SignFlowActive SignFlow",onSubmit:this.handleSubmit},this.renderAccountInfo(),"email"!==t&&[D.a.createElement(F.a,{key:"sms-input",manualValidateError:c,interceptTime:n,countDownEvent:this.handleSendDigits,countDownEndEvent:this.handleCountDownEndEvent,smsType:r,reStartTime:i}),o&&D.a.createElement("div",{key:"smsBackUp-button",className:"SignFlowActive-options"},D.a.createElement(B.default,{preset:"plain",className:"SignFlowActive-cutSmsType",onClick:this.handleChangeSmsType},"接收"+a+"验证码"))],D.a.createElement(B.default,{className:"email"===t?"SignFlowActive-sendEmail":"SignFlowActive-sendDigits",preset:"primary",color:"blue",type:"submit"},"email"===t?"发送激活邮件":"激活"))}}]),t}(I.Component),S.propTypes={email:R.a.string,sendDigitsError:R.a.object,getUnlockTicketAndDigits:R.a.func,activeUserByEmail:R.a.func,validateAndActiveUserByEmail:R.a.func,activeConfirmSucceeded:R.a.bool,activeConfirmError:R.a.object,onClose:R.a.func},E=C))||E,H=q,W=n(38),z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Q=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Y=(k=O=function(e){function t(){var e,n,r,a;u(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=r=l(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.state={snackbar:null},r.handleSetSnackbar=function(e){return r.setState({snackbar:e})},a=n,l(r,a)}return p(t,e),Q(t,[{key:"render",value:function(){var e=this.props,t=e.shown,n=e.onClose,r=c(e,["shown","onClose"]);return D.a.createElement(W.default,{className:"SignFlow-modal",title:"激活帐号",subtitle:"为了正常使用知乎的提问、回答、评论和编辑功能，请绑定你的手机",onClose:n,maskClosable:!1,footer:this.state.snackbar},t&&D.a.createElement(H,z({onClose:n,onSetSnackbar:this.handleSetSnackbar},r)))}}]),t}(I.Component),O.propTypes={shown:R.a.bool.isRequired,onClose:R.a.func.isRequired},k),X=Y,K=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Z=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),G=(N=T=function(e){function t(){return h(this,t),d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return m(t,e),Z(t,[{key:"render",value:function(){var e=this.props,t=e.isInModal,n=e.shown,r=e.onClose,a=f(e,["isInModal","shown","onClose"]);return D.a.createElement("div",null,t?D.a.createElement(X,K({onClose:r,shown:n},a)):D.a.createElement(H,a))}}]),t}(I.Component),T.propTypes={isInModal:R.a.bool,shown:R.a.bool,onClose:R.a.func},T.defaultProps={isInModal:!1},N),$=G,J=(n(305),$),ee=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},te=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),ne=(j=P=function(e){function t(){return y(this,t),v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return b(t,e),te(t,[{key:"render",value:function(){var e=this.props,t=e.type,n=g(e,["type"]),r=ee({isInModal:!0},n);return D.a.createElement("div",{className:"SignFlowModal"},D.a.createElement(J,ee({},r,{shown:"active"===t})))}}]),t}(I.Component),P.propTypes={type:R.a.oneOf(["initial","active"]),onClose:R.a.func.isRequired},j);t.default=ne},1245:function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function w(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function C(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function T(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var N,P,j,_,R,I,D,A,B,M,V,x,U,F,L=n(1),q=n.n(L),H=n(0),W=n.n(H),z=n(4),Q=n(294),Y=n(3),X=n(14),K=n.n(X),Z=n(6),G=n.n(Z),$=n(798),J=n(803),ee=n(887),te=n(888),ne=n(802),re=(n(1234),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}),ae=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),oe=function(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["","s 后可重发"],["","s 后可重发"]),ie=(N=Object(z.connect)(function(e){return{isIOS:e.env.userAgent.iOS}}))((_=j=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),ae(t,[{key:"render",value:function(){var e=this.props,t=e.countDownEvent,n=e.startAtOnce,o=e.interceptTime,i=e.resetText,s=e.manualValidateError,c=e.onChange,u=e.validations,l=e.countDownEndEvent,p=e.reStartTime,f=e.isIOS,h=a(e,["countDownEvent","startAtOnce","interceptTime","resetText","manualValidateError","onChange","validations","countDownEndEvent","reStartTime","isIOS"]);return W.a.createElement("div",{className:"SignFlow SignFlow-smsBindPhoneInputContainer"},W.a.createElement(ne.a,re({name:"digits",className:"SignFlow-smsBindPhoneInput",type:f?"tel":"number",errorMessageClassName:"SignFlow-smsBindPhoneInputErrorMask",placeholder:"输入 6 位验证码",manualValidateError:s,onChange:c,validations:[{type:"required",message:"请填写验证码",className:"SignFlow-smsInputBindPhoneRequiredErrorMask"}].concat(r(u||[]))},h)),W.a.createElement(ee.a,{className:"SignFlow-smsBindPhoneInputButton",preset:"plain",initialText:"发送验证码",resetText:i,countingText:Object(te.a)(oe,"count"),startAtOnce:n,event:t,countDownEndEvent:l,interceptTime:o,reStartTime:p}))}}]),t}(H.Component),j.propTypes={countDownEvent:q.a.func.isRequired,startAtOnce:q.a.bool,interceptTime:q.a.number,resetText:q.a.string,manualValidateError:q.a.string},j.defaultProps={startAtOnce:!1,resetText:"重发验证码"},P=_))||P,se=ie,ce=n(7),ue=(n(890),n(891),function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}()),le=(I=R=function(e){function t(){var e,n,r,a;u(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=r=l(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.state={selectedCountry:{code:"+86",name:"中国"},phoneNo:null,smsInputInterceptTime:-1,manualError:null,showFooter:!1,sendValidationCodeButtonText:"发送验证码",identifyingCodeError:null},r.testPhoneNo=function(){var e=r.state,t=e.selectedCountry.code,n=e.phoneNo,a=/^\d{11}$/;return"+86"!==t||a.test(n)},r.handleChange=function(e){return function(t){r.setState(c({},e,t))}},r.handleSendDigits=function(e){var t=r.props.requestPhoneVerificationCode,n=r.state,a=n.selectedCountry.code,o=n.phoneNo,i=n.manualError;if(G.a.trackEvent(e.target,{action:"GetCaptcha"}),r.testPhoneNo())return t(""+a+o).then(function(){r.setState({manualError:null})}).catch(function(e){var t=e.payload;t=void 0===t?{}:t;var n=t.message;return r.setState({manualError:n,smsInputInterceptTime:Date.now()})});return r.setState({manualError:"请输入正确的手机号"===i?" 请输入正确的手机号":"请输入正确的手机号",smsInputInterceptTime:Date.now()})},r.handleSubmit=function(e){var t=e.phoneNo,n=e.digits,a=r.props,o=a.updatePhoneNumber,i=a.onSuccess,s=a.onNeedUnbind,c=r.state,u=c.selectedCountry.code,l=c.identifyingCodeError;o(""+u+t,n).then(function(e){var n=e.payload,r=n.data;if(n.success)return i();var a=r.bindedAccountFullname,o=r.requestAccountFullname;return s({phoneNumber:t,bindName:a,requiredName:o})}).catch(function(e){var t=e.payload;t=void 0===t?{}:t;var n=t.code,a=t.message;n===ce.n&&r.setState({identifyingCodeError:l===a?" "+a:a})})},r.handleZaOK=function(e){G.a.trackEvent(e.target,{action:"Ok"})},r.renderContent=function(){var e=r.state,t=e.smsInputInterceptTime,n=e.manualError,a=e.sendValidationCodeButtonText,o=e.identifyingCodeError;return W.a.createElement("div",{ref:function(e){r.container=e}},W.a.createElement($.b,{className:"SignFlowActive SignFlow BindPhoneForm",onSubmit:r.handleSubmit},void 0,W.a.createElement(J.a,{type:"register",supportedCountriesShown:!0,manualValidateError:n,onSelect:r.handleChange("selectedCountry"),onChange:r.handleChange("phoneNo")}),W.a.createElement(se,{key:"sms-input",resetText:a,interceptTime:t,countDownEvent:r.handleSendDigits,manualValidateError:o}),W.a.createElement("div",{className:"BindPhone-helpWrapper"},W.a.createElement(Y.default,{className:"BindPhone-helpText",preset:"link",onClick:function(){r.setState({showFooter:!0})}},"需要帮助？")),W.a.createElement(Y.default,{className:"SignFlowActive-sendDigits",preset:"primary",color:"blue",type:"submit",onClick:r.handleZaOK},"确认")))},a=n,l(r,a)}return p(t,e),ue(t,[{key:"componentDidMount",value:function(){G.a.setModule(this.container,{module:"BindPhoneForm"}),G.a.trackCardShow(this.container)}},{key:"render",value:function(){var e=this.props.onClose,t=this.state.showFooter;return W.a.createElement(K.a,{title:"设置手机号",subtitle:"绑定手机后，你就可以使用知乎的提问、回答、评论等功能。",footer:t?"如需要帮助，请联系 i@zhihu.com，我们会尽快帮你解决":null,onClose:e,size:"default"},this.renderContent())}}]),t}(H.Component),R.propTypes={requestPhoneVerificationCode:q.a.func.isRequired,updatePhoneNumber:q.a.func.isRequired,onClose:q.a.func.isRequired,onSuccess:q.a.func.isRequired,onNeedUnbind:q.a.func.isRequired},I),pe=n(42),fe=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),he=(A=D=function(e){function t(){var e,n,r,a;f(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=r=h(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.zaKnowMore=function(e){G.a.trackEvent(e.target,{action:"OpenUrl",name:"了解更多"})},r.toBindPhone=function(e){var t=r.props.onBindPhone;G.a.trackEvent(e.target,{action:"OpenUrl",name:"去绑定手机"}),t()},r.handleClose=function(e){var t=r.props,n=t.onClose,a=t.config.canWrite;G.a.trackEvent(e.target,{action:"Cancel",name:a?"暂不绑定":"取消"}),n()},r.renderContent=function(){var e=r.props.config,t=e.tip,n=e.canWrite;return W.a.createElement("div",{ref:function(e){r.container=e}},W.a.createElement("p",null,t,W.a.createElement(pe.a,{preset:"link",target:"_blank",href:"https://zhuanlan.zhihu.com/p/27257715",onClick:r.zaKnowMore},"了解更多")),W.a.createElement("div",{className:"BindPhone-buttonSection"},W.a.createElement(pe.a,{className:"BindPhone-button",onClick:r.handleClose},n?"暂不绑定":"取消"),W.a.createElement(Y.default,{className:"BindPhone-button",preset:"primary",color:"blue",onClick:r.toBindPhone},"去绑定手机")))},a=n,h(r,a)}return d(t,e),fe(t,[{key:"componentDidMount",value:function(){G.a.setModule(this.container,{module:"BindPhoneForm"}),G.a.trackCardShow(this.container)}},{key:"render",value:function(){var e=this.props.onClose;return W.a.createElement(K.a,{className:void 0,title:"绑定手机",onClose:e,size:"default"},this.renderContent())}}]),t}(H.Component),D.propTypes={config:q.a.object,onClose:q.a.func,onBindPhone:q.a.func},A),de=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),me=(M=B=function(e){function t(){var e,n,r,a;m(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=r=g(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.handleCancel=function(e){var t=r.props.onClose;G.a.trackEvent(e.target,{action:"Cancel",name:"不绑定"}),t()},a=n,g(r,a)}return y(t,e),de(t,[{key:"componentDidMount",value:function(){G.a.setModule(this.container,{module:"BindMailForm"}),G.a.trackCardShow(this.container)}},{key:"render",value:function(){var e=this,t=this.props.onClose;return W.a.createElement(K.a,{className:void 0,title:"手机号绑定成功",onClose:t,size:"default"},W.a.createElement("div",{ref:function(t){e.container=t}},W.a.createElement("p",null,"由于你此前绑定的邮箱未经验证，未来请使用手机号登录知乎。"),W.a.createElement(Y.default,{className:"BindPhone-remindLoginWithPhoneButton",onClick:this.handleCancel,preset:"primary",color:"blue"},"知道了")))}}]),t}(H.Component),B.propTypes={onClose:q.a.func},M),ge=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),ye=(x=V=function(e){function t(){var e,n,r,a;v(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=r=b(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.handleCancel=function(e){var t=r.props.onCancel;G.a.trackEvent(e.target,{action:"Click",name:"暂不绑定"}),t()},r.handleConfirm=function(e){var t=r.props.onConfirm;G.a.trackEvent(e.target,{action:"Click",name:"确认解绑"}),t()},a=n,b(r,a)}return w(t,e),ge(t,[{key:"componentDidMount",value:function(){G.a.setModule(this.container,{module:"BindPhoneFailForm"}),G.a.trackCardShow(this.container)}},{key:"render",value:function(){var e=this,t=this.props,n=t.onClose,r=t.phoneNumber,a=t.bindName,o=t.requiredName;return W.a.createElement(K.a,{className:void 0,title:"绑定失败",onClose:n,size:"default"},W.a.createElement("div",{ref:function(t){e.container=t}},W.a.createElement("p",null,"你所输入的手机号 ",r," 已经被绑定到帐号「",a,"」。"),void 0,W.a.createElement("p",null,"你可以选择将该手机号从该帐号中解绑，并绑定至当前帐号「",o,"」。"),void 0,W.a.createElement("p",null,W.a.createElement("b",null,"解绑后，你将无法再通过手机号登录原帐号「",a,"」。")),W.a.createElement("div",{className:"BindPhone-buttonSection"},W.a.createElement(Y.default,{className:"BindPhone-button",onClick:this.handleConfirm},"确认解绑"),W.a.createElement(Y.default,{className:"BindPhone-button",preset:"primary",color:"blue",onClick:this.handleCancel},"暂不绑定"))))}}]),t}(H.Component),V.propTypes={onClose:q.a.func.isRequired,onCancel:q.a.func.isRequired,onConfirm:q.a.func.isRequired,phoneNumber:q.a.string.isRequired,bindName:q.a.string.isRequired,requiredName:q.a.string.isRequired},x),ve=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),be=(F=U=function(e){function t(){var e,n,r,a;E(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=r=S(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.handleUnbind=function(e){var t=r.props,n=t.onSuccess,a=t.monopolizePhoneNumber,o=t.showNotification;G.a.trackEvent(e.target,{action:"Click",name:"确认解绑"}),a().then(function(){return o("绑定成功！","white"),n()})},r.handleCancel=function(e){var t=r.props.onCancel;G.a.trackEvent(e.target,{action:"Click",name:"暂不绑定"}),t()},a=n,S(r,a)}return C(t,e),ve(t,[{key:"componentDidMount",value:function(){G.a.setModule(this.container,{module:"BindPhoneVerifyForm"}),G.a.trackCardShow(this.container)}},{key:"render",value:function(){var e=this,t=this.props,n=t.onClose,r=t.bindName;return W.a.createElement(K.a,{className:void 0,title:"解绑手机",onClose:n,size:"default"},W.a.createElement("div",{ref:function(t){e.container=t}},W.a.createElement("p",null,W.a.createElement("b",null,"解绑操作无法撤销。")),void 0,W.a.createElement("p",null,"如果你没有其他登录方式，你将无法再使用帐号「",r,"」。"),W.a.createElement("div",{className:"BindPhone-buttonSection"},W.a.createElement(Y.default,{className:"BindPhone-button",onClick:this.handleUnbind},"确认解绑"),W.a.createElement(Y.default,{className:"BindPhone-button",preset:"primary",color:"blue",onClick:this.handleCancel},"暂不绑定"))))}}]),t}(H.Component),U.propTypes={onClose:q.a.func.isRequired,onSuccess:q.a.func.isRequired,onCancel:q.a.func.isRequired,bindName:q.a.string.isRequired,showNotification:q.a.func.isRequired,monopolizePhoneNumber:q.a.string.isRequired},F),we=n(171),Ee=n(12);n.d(t,"default",function(){return _e});var Se,Ce,Oe,ke,Te=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Ne="LOGIN_WITH_PHONE",Pe="NEED_UNBIND",je=function(e){var t=e.account,n=e.entities,r=n.users[e.currentUser],a=r.isActive,o=r.email;return{account:t,hasActiveEmail:a&&o,needShowLoginWithPhoneNumber:!a&&!!o,config:ce.w,isWindow:ce.w.isWindow}},_e=(Se=Object(z.connect)(je,{requestPhoneVerificationCode:we.f,updatePhoneNumber:we.j,monopolizePhoneNumber:we.d,showNotification:Ee.g,getUnlockRequest:we.c,unlockTicketByDigits:we.h,requestUnlockTicket:we.g,unlockTicketByPassword:we.i}))((ke=Oe=function(e){function t(){var e,n,r,a;O(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=r=k(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.state={},r.handleBindPhoneSuccess=function(){var e=r.props,t=e.needShowLoginWithPhoneNumber,n=e.showNotification,a=e.onToggle;return t?r.goToStep(Ne)():(n("绑定成功！","white"),setTimeout(function(){return location.reload()},2e3),a())},r.handleNeedUnbind=function(e){var t=e.bindName,n=e.phoneNumber,a=e.requiredName;return r.setState({bindName:t,phoneNumber:n,requiredName:a,step:Pe})},r.goToStep=function(e){return function(){return r.setState({step:e})}},r.handleCloseWithReload=function(){return location.reload()},a=n,k(r,a)}return T(t,e),Te(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.getUnlockRequest,r=t.hasActiveEmail,a=t.shown,o=t.isWindow,i=t.account,s=i.errorStatus,c=i.challenge,u=document.querySelector(".VerificationDialogModalHeader");if(e.shown&&!a){o||n();var l="";l=r?"CONFIRM_BIND_PHONE":!o&&s&&!u&&c&&c.length?"SAFETY_VERIFICATION":"BIND_PHONE",this.setState({step:l})}}},{key:"render",value:function(){var e=this.props,t=e.shown,n=e.requestPhoneVerificationCode,r=e.updatePhoneNumber,a=e.monopolizePhoneNumber,o=e.showNotification,i=e.config,s=e.account,c=e.isWindow,u=e.unlockTicketByDigits,l=e.requestUnlockTicket,p=e.unlockTicketByPassword,f=e.onToggle,h=this.state,d=h.step,m=h.bindName,g=h.phoneNumber,y=h.requiredName;return t?"CONFIRM_BIND_PHONE"===d?W.a.createElement(he,{onBindPhone:this.goToStep(c?"BIND_PHONE":"SAFETY_VERIFICATION"),onClose:f,config:i}):"BIND_PHONE"===d?W.a.createElement(le,{onClose:f,onSuccess:this.handleBindPhoneSuccess,onNeedUnbind:this.handleNeedUnbind,requestPhoneVerificationCode:n,updatePhoneNumber:r}):d===Ne?W.a.createElement(me,{onClose:this.handleCloseWithReload}):d===Pe?W.a.createElement(ye,{onClose:f,onCancel:this.goToStep("BIND_PHONE"),onConfirm:this.goToStep("CONFIRM_UNBIND"),bindName:m,phoneNumber:g,requiredName:y}):"CONFIRM_UNBIND"===d?W.a.createElement(be,{onClose:f,onSuccess:this.handleBindPhoneSuccess,onCancel:this.goToStep("BIND_PHONE"),bindName:m,monopolizePhoneNumber:a,showNotification:o}):"SAFETY_VERIFICATION"===d?W.a.createElement(Q.VerificationModal,{account:s,unlockTicketByDigits:u,requestUnlockTicket:l,unlockTicketByPassword:p,onClose:f,onSuccess:this.goToStep("BIND_PHONE"),zaModuleName:"BindMailForm"}):null:null}}]),t}(H.Component),Oe.propTypes={shown:q.a.bool.isRequired,onToggle:q.a.func.isRequired,needShowLoginWithPhoneNumber:q.a.bool.isRequired,config:q.a.object.isRequired,requestPhoneVerificationCode:q.a.func.isRequired,updatePhoneNumber:q.a.func.isRequired,monopolizePhoneNumber:q.a.func.isRequired},Ce=ke))||Ce},798:function(e,t,n){"use strict";function r(e,t){return t?e.trim():e}function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e){function t(e){for(var t=o[e],n=arguments.length,r=Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return"function"==typeof t?t.apply(void 0,r):void 0}var n=e.contextTypes,r=e.defaultProps,o=Object.assign({},e.prototype);Object.assign(e.prototype,{componentWillMount:function(){var e=this.context.form;e&&(e.attachToForm(this),this.setState({_value:"",_validations:[]}));for(var n=arguments.length,r=Array(n),a=0;a<n;a++)r[a]=arguments[a];return t.apply(void 0,["componentWillMount"].concat(r))},componentWillUnmount:function(){var e=this.context.form;e&&e.detachFromForm(this);for(var n=arguments.length,r=Array(n),a=0;a<n;a++)r[a]=arguments[a];return t.apply(void 0,["componentWillUnmount"].concat(r))},getValue:function(){var e=this.state||{},t=e._value;return null==t?"":t},setValue:function(e,t){this.setState({_value:e},function(){"function"==typeof t&&t()})},getValidationMessage:function(){var e=this.getValidationMessages();return e&&e[0]},getValidationClassName:function(){var e=this.state||{},t=e._validations;return t&&t[0]&&t[0].className},getValidationMessages:function(){var e=this.state||{},t=e._validations;return t&&t.map(function(e){return e.message})},setValidations:function(e){var t=this;this.setState({_validations:e},function(){return t.forceUpdate()})},clearValidations:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=this.state||{},r=n._validations;r&&r.length>0&&this.setState(O({},e,{_validations:[]}),t)},addValidation:function(e){this.setState(function(t){var n=t._validations;return{_validations:[e].concat(a(n||[]))}})},addManualValidation:function(e){this.addValidation({type:"manual",message:e})},validate:function(){this.context.form.validate(this)}}),Object.assign(e,{contextTypes:O({},n,{form:d.a.object}),defaultProps:O({},r,{validations:[]})})}function i(){return function(e){return o(e)}}function s(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var h=n(1),d=n.n(h),m=n(0),g=n.n(m),y=n(15),v=n(4),b=n(22),w=n.n(b),E={useTrim:!0},S={required:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";arguments[1];return""!==r(e,(arguments.length>2&&void 0!==arguments[2]?arguments[2]:E).useTrim)},maxLength:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1];return r(e,(arguments.length>2&&void 0!==arguments[2]?arguments[2]:E).useTrim).length<=t},minLength:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1];return r(e,(arguments.length>2&&void 0!==arguments[2]?arguments[2]:E).useTrim).length>=t},pattern:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:E,a=n.useTrim;return t.test(r(e,a))}},C=S,O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};n.d(t,"b",function(){return R}),n.d(t,"a",function(){return i});var k,T,N,P,j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),R=(k=Object(v.connect)(function(e){return{isWechat:e.env.userAgent.Wechat}}))((P=N=function(e){function t(){var e,n,r,a;l(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=r=p(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.state={isValid:!0},r.inputs=[],r.attachToForm=function(e){var t=e.props.name;if(!t||r.inputs.includes(t))throw new Error("form input must specify a unqie name, but current is "+t);r.inputs.push(e)},r.detachFromForm=function(e){var t=r.inputs.indexOf(e);-1!==t&&(r.inputs=[].concat(u(r.inputs.slice(0,t)),u(r.inputs.slice(t+1))))},r.validate=function(e){var t=e.state._value,n=e.props.validations,r=[],a=[];return n?(!Array.isArray(n)&&n.type&&(n=[n]),n.forEach(function(e){var n=e.type,o=e.value,i=e.options,s=C[n];if(!s)throw new Error("no "+n+" rules, please define it at Form.validateRules");var c=s(t,o,i);"function"==typeof c.then?a=[].concat(u(a),[c.then(function(){},function(){r.push(e)})]):c||(r=[].concat(u(r),[e]))}),Promise.all(a).then(function(){return e.setValidations(r),r})):r},r.handleSubmit=function(e){e.preventDefault();var t=r.props,n=t.onPreSubmit,a=t.onSubmit,o=t.isWechat;if(n(),o)return void new Promise(function(e){var t=r.inputs.find(function(e){return"username"===e.props.name});t&&!t.state._value&&Object(y.findDOMNode)(t.inputEl).value&&t.handleChange({target:{value:Object(y.findDOMNode)(t.inputEl).value}});var n=r.inputs.find(function(e){return"password"===e.props.name});n&&!n.state._value&&Object(y.findDOMNode)(t.inputEl).value&&n.handleChange({target:{value:Object(y.findDOMNode)(n.inputEl).value}}),e()}).then(function(){r.validateAll().then(function(e){if(e){var t=r.inputs.reduce(function(e,t){return j({},e,c({},t.props.name,t.state._value))},{});a(t)}})});r.validateAll().then(function(e){if(e){var t=r.inputs.reduce(function(e,t){return j({},e,c({},t.props.name,t.state._value))},{});a(t)}})},a=n,p(r,a)}return f(t,e),_(t,[{key:"getChildContext",value:function(){return{form:{attachToForm:this.attachToForm,detachFromForm:this.detachFromForm,getValue:this.getValue,setValue:this.setValue,validate:this.validate}}}},{key:"componentDidMount",value:function(){}},{key:"validateAll",value:function(){var e=this,t=this.props,n=t.onValid,r=t.onInvalid,a=[],o=[];return this.inputs.forEach(function(t){var n=e.validate(t);n&&"function"==typeof n.then?o=[].concat(u(o),[n.then(function(e){a=[].concat(u(a),u(e))})]):n&&(a=[].concat(u(a),u(n)))}),Promise.all(o).then(function(){var t=0===a.length;return e.setState({isValid:t},function(){t?n():r(a.map(function(e){return e.message}))}),t})}},{key:"render",value:function(){var e=w()(this.props,["onValid","onInvalid","onSubmit","onPreSubmit","isWechat","dispatch"]),t=e.children,n=e.onRef,r=s(e,["children","onRef"]);return g.a.createElement("form",j({noValidate:!0,onSubmit:this.handleSubmit,ref:n},r),t)}}]),t}(m.Component),N.childContextTypes={form:d.a.object},N.propTypes={onValid:d.a.func,onInvalid:d.a.func,onSubmit:d.a.func,onPreSubmit:d.a.func},N.validateRules=C,N.defaultProps={onValid:function(){},onInvalid:function(){},onSubmit:function(){},onPreSubmit:function(){}},T=P))||T},802:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n.d(t,"a",function(){return k});var c,u,l,p,f=n(1),h=n.n(f),d=n(0),m=n.n(d),g=n(2),y=n.n(g),v=n(22),b=n.n(v),w=n(48),E=n(798),S=n(1220),C=(n.n(S),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}),O=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),k=(c=Object(E.a)())((p=l=function(e){function t(){var e,n,r,a;o(this,t);for(var s=arguments.length,c=Array(s),u=0;u<s;u++)c[u]=arguments[u];return n=r=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),r.handleErrorHide=function(){r.getValidationMessage()&&r.setState({errorMaskShown:!1},function(){r.clearValidations({errorMaskShown:!0},function(){return r.inputEl.focus()})})},r.handleKeyUp=function(e){8!==e.keyCode&&9!==e.keyCode||r.clearValidations()},r.handleChange=function(e){var t=e.target.value,n=r.props.onChange;r.setValue(t),"function"==typeof n&&n(t)},a=n,i(r,a)}return s(t,e),O(t,[{key:"componentDidMount",value:function(){var e=this.props.defaultValue;e&&this.setValue(e),this.setState({errorMaskShown:!0})}},{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.manualValidateError,r=t.type,a=t.smsType,o=e.manualValidateError,i=e.type,s=e.defaultValue,c=e.smsType;!n&&o||"string"==typeof n&&n!==o?this.addManualValidation(o):n&&!o&&this.clearValidations({errorMaskShown:!0}),r===i&&a===c||(this.setValue(s),this.clearValidations({errorMaskShown:!0}))}},{key:"render",value:function(){var e,t=this,n=b()(this.props,["validations","defaultValue","onChange","smsType","manualValidateError","dispatch"]),o=n.className,i=n.inputClassName,s=n.errorMessageClassName,c=a(n,["className","inputClassName","errorMessageClassName"]),u=this.state||{},l=u.errorMaskShown,p=this.getValue(),f=this.getValidationMessage();return m.a.createElement("div",{className:y()("SignFlowInput",o)},m.a.createElement(w.default,C({onRef:function(e){t.inputEl=e},value:p,onChange:this.handleChange,onKeyUp:this.handleKeyUp,onClick:this.handleErrorHide,onBlur:function(){return t.validate()},className:i},c)),m.a.createElement("div",{className:y()("SignFlowInput-errorMask",this.getValidationClassName(),(e={},r(e,s,f),r(e,"SignFlowInput-requiredErrorMask",!p),r(e,"SignFlowInput-errorMask--hidden",!f||!l),e)),onClick:this.handleErrorHide},f))}}]),t}(d.Component),l.propTypes={inputClassName:h.a.string,errorMessageClassName:h.a.string,manualValidateError:h.a.node},u=p))||u},803:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e){return{supportedCountries:e.sms.supportedCountries}}var p,f,h,d,m=n(1),g=n.n(m),y=n(0),v=n.n(y),b=n(4),w=n(110),E=n(22),S=n.n(E),C=n(112),O=n(802),k=n(8),T=(n(1221),function(){function e(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()),N=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),P=(function(e){function t(){var e,n,o,i;r(this,t);for(var s=arguments.length,c=Array(s),u=0;u<s;u++)c[u]=arguments[u];return n=o=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),o.handleChange=function(e){var t=e.target.value.match(/\+\d+/),n=T(t,1),r=n[0];o.codeDiv.innerHTML=r;var a=o.props.items.findIndex(function(e){return e.code===r});o.props.onChange(e.target.value,a)},i=n,a(o,i)}o(t,e),N(t,[{key:"render",value:function(){var e=this,t=this.props.items;return v.a.createElement("div",{className:"MobileContriesSelect"},v.a.createElement("div",{className:"MobileContriesSelect-content"},v.a.createElement("div",{ref:function(t){e.codeDiv=t}},"+ 86"),v.a.createElement("select",{onChange:this.handleChange},t.map(function(e,t){var n=e.name,r=e.code;return v.a.createElement("option",{key:t,value:n+" "+r},n+" "+r)}))),v.a.createElement(k.Select,null))}}])}(y.Component),n(1222),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}),j=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_=(p=Object(b.connect)(l,{getSupportedCountries:C.b}))((d=h=function(e){function t(){var e,n,r,a;s(this,t);for(var o=arguments.length,i=Array(o),u=0;u<o;u++)i[u]=arguments[u];return n=r=c(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),r.state={selectedCountry:null},r.handleSelect=function(e,t){var n=r.props,a=n.supportedCountries,o=n.onSelect,i=a[t];r.setState({selectedCountry:i}),o(i)},a=n,c(r,a)}return u(t,e),j(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.supportedCountries,n=e.getSupportedCountries;t&&t.length||n()}},{key:"render",value:function(){var e=S()(this.props,["getSupportedCountries","onSelect"]),n=e.supportedCountries,r=e.onChange,a=e.defaultPhoneNo,o=e.type,s=e.defaultSelectedCountry,c=e.supportedCountriesShown,u=e.placeholderPrefix,l=void 0===u?"":u,p=i(e,["supportedCountries","onChange","defaultPhoneNo","type","defaultSelectedCountry","supportedCountriesShown","placeholderPrefix"]),f=this.state.selectedCountry,h=f||s,d=h.name,m=h.code,g=Boolean(c&&n&&n.length);return v.a.createElement("div",{className:"SignFlow-account"},v.a.createElement("div",{className:"SignFlow-supportedCountriesSelectContainer"},Boolean(n)&&Boolean(n.length)&&g&&v.a.createElement(w.default,{plain:!0,text:d+" "+m,onChange:this.handleSelect,className:"SignFlow-supportedCountriesSelect",targetClassName:"SignFlow-supportedCountriesList"},n.map(function(e,t){var n=e.name,r=e.code;return v.a.createElement(w.Option,{key:t,value:n+" "+r})}))),g&&v.a.createElement("span",{className:"SignFlow-accountSeperator"}," "),v.a.createElement(O.a,P({className:"SignFlow-accountInputContainer",name:"register"===o?"phoneNo":"username",inputClassName:"SignFlow-accountInput",placeholder:t.getPlaceholder(o,l),onChange:r,defaultValue:a,validations:[{type:"required",message:t.getPlaceholder(o,"请输入")}],type:"digits"===o||"register"===o?"tel":"text"},p)))}}]),t}(y.Component),h.propTypes={defaultPhoneNo:g.a.string,defaultSelectedCountry:g.a.object,supportedCountries:g.a.array,onSelect:g.a.func,onChange:g.a.func,getSupportedCountries:g.a.func,type:g.a.oneOf(["register","digits","password"]).isRequired,supportedCountriesShown:g.a.bool,placeholderPrefix:g.a.string},h.defaultProps={defaultPhoneNo:"",defaultSelectedCountry:{name:"中国",code:"+86"},supportedCountriesShown:!0},h.getPlaceholder=function(e,t){return t+("digits"===e||"register"===e?"手机号":"手机号或邮箱")},f=d))||f;t.a=_},821:function(e,t,n){"use strict";function r(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s,c,u=n(1),l=n.n(u),p=n(0),f=n.n(p),h=n(887),d=n(888),m=n(802),g=n(1224),y=(n.n(g),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}),v=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),b=function(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}([""," 秒后可重发"],[""," 秒后可重发"]),w=(c=s=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),v(t,[{key:"render",value:function(){var e=this.props,t=e.countDownEvent,n=e.countDownEndEvent,a=e.startAtOnce,o=e.interceptTime,i=e.isEmail,s=e.reStartTime,c=e.smsType,u=r(e,["countDownEvent","countDownEndEvent","startAtOnce","interceptTime","isEmail","reStartTime","smsType"]),l=void 0;return l=i?"邮箱":"voice"===c?"语音":"短信",f.a.createElement("div",{className:"SignFlow SignFlow-smsInputContainer"},f.a.createElement(m.a,y({name:"digits",className:"SignFlow-smsInput",type:"number",smsType:c,errorMessageClassName:"SignFlow-smsInputErrorMessage",placeholder:"输入 6 位"+l+"验证码",validations:[{type:"required",message:"请输入"+l+"验证码",className:"SignFlow-smsInputRequiredErrorMask"}]},u)),f.a.createElement(h.a,{className:"SignFlow-smsInputButton",preset:"plain",initialText:"获取"+l+"验证码",resetText:"重新获取"+l+"验证码",countingText:Object(d.a)(b,"count"),startAtOnce:a,event:t,countDownEndEvent:n,interceptTime:o,reStartTime:s}))}}]),t}(p.Component),s.propTypes={countDownEvent:l.a.func.isRequired,startAtOnce:l.a.bool,interceptTime:l.a.number,reStartTime:l.a.number,isEmail:l.a.bool,countDownEndEvent:l.a.func,smsType:l.a.string},s.defaultProps={startAtOnce:!1,isEmail:!1},c);t.a=w},840:function(e,t){},841:function(e,t){},887:function(e,t,n){"use strict";function r(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s,c,u=n(1),l=n.n(u),p=n(0),f=n.n(p),h=n(2),d=n.n(h),m=n(3),g=n(22),y=n.n(g),v=n(1223),b=(n.n(v),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}),w=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),E=(c=s=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.clearTimer=function(){n.timer&&window.clearInterval(n.timer)},n.handleClick=function(e){n.state.isCounting||n.startTiming(e)},n.state={countDownTime:e.countDownTime,isCounting:!1},n.isInitialState=!0,n}return i(t,e),w(t,[{key:"componentDidMount",value:function(){this.props.startAtOnce&&this.startTiming()}},{key:"componentWillReceiveProps",value:function(e){var t=this.props,n=t.interceptTime,r=t.reStartTime,a=e.interceptTime,o=e.reStartTime;n!==a&&this.resetTiming(),r!==o&&(this.resetTiming(),this.startTiming())}},{key:"componentWillUnmount",value:function(){this.clearTimer()}},{key:"resetTiming",value:function(){this.clearTimer(),this.setState({countDownTime:this.props.countDownTime,isCounting:!1})}},{key:"startTiming",value:function(e){var t=this,n=this.props,r=n.event,a=n.countDownEndEvent;"function"==typeof r&&r(e),this.isInitialState=!1,this.setState({isCounting:!0}),this.timer=setInterval(function(){var e=t.state.countDownTime;e<=0?(a&&a(),t.resetTiming()):t.setState({countDownTime:e-1})},1e3)}},{key:"renderText",value:function(){var e=this.props,t=e.initialText,n=e.resetText,r=e.countingText,a=this.state,o=a.countDownTime;return a.isCounting?r({count:o}):this.isInitialState?t:n||t}},{key:"render",value:function(){var e=y()(this.props,["initialText","resetText","countingText","startAtOnce","countDownTime","event","interceptTime","countDownEndEvent","reStartTime"]),t=e.className,n=e.disabled,a=r(e,["className","disabled"]),o=this.state.isCounting;return f.a.createElement(m.default,b({className:d()("CountingDownButton",t,{"is-counting":o})},a,{onClick:this.handleClick,disabled:n||o}),this.renderText())}}]),t}(p.Component),s.propTypes={countDownTime:l.a.number,startAtOnce:l.a.bool,initialText:l.a.string.isRequired,resetText:l.a.string,countingText:l.a.func.isRequired,event:l.a.func,countDownEndEvent:l.a.func,interceptTime:l.a.number,reStartTime:l.a.number},s.defaultProps={countDownTime:60,startAtOnce:!1,interceptTime:-1,reStartTime:-1},c);t.a=E},888:function(e,t,n){"use strict";function r(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];var i=r[r.length-1]||{};return n.reduce(function(t,n,o){return t.concat(a(n)&&r[n]||i[n],e[o+1])},[e[0]]).join("")}}t.a=r;var a=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}},889:function(e,t){},890:function(e,t){},891:function(e,t){}});
//# sourceMappingURL=column.signflow.51b2ced6040d64affc74.js.map